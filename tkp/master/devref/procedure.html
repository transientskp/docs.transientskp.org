<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Development Procedure &mdash; LOFAR Transients Pipeline 2.0-pre documentation</title>
    
    <link rel="stylesheet" href="../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0-pre',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/lofar.ico"/>
    <link rel="top" title="LOFAR Transients Pipeline 2.0-pre documentation" href="../index.html" />
    <link rel="up" title="Developer’s Reference Guide" href="index.html" />
    <link rel="next" title="Guidelines for Developers" href="developing.html" />
    <link rel="prev" title="Developer’s Reference Guide" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="developing.html" title="Guidelines for Developers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Developer’s Reference Guide"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">LOFAR Transients Pipeline 2.0-pre documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Developer&#8217;s Reference Guide</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="development-procedure">
<span id="dev-procedure"></span><h1>Development Procedure<a class="headerlink" href="#development-procedure" title="Permalink to this headline">¶</a></h1>
<p>This document describes the development process used when working on the TraP.
All developers are encouraged to familiarize themselves with this material
before making any changes to the code.</p>
<div class="section" id="accessing-the-code">
<h2>Accessing the Code<a class="headerlink" href="#accessing-the-code" title="Permalink to this headline">¶</a></h2>
<p>All code relating to the core TraP functionality is hosted in the
<a class="reference external" href="https://github.com/transientskp/tkp">transientskp/tkp</a> <tt class="docutils literal"><span class="pre">git</span></tt> repository
on <a class="reference external" href="https://github.com/">GitHub</a>.</p>
<p>The repository is currently only available to authorized project members. If
you require access, contact <tt class="docutils literal"><span class="pre">git&#64;transientskp.org</span></tt> for help. Please <em>do
not</em> redistribute the code without authorization.</p>
<p>You will need to be familiar with basic <tt class="docutils literal"><span class="pre">git</span></tt> operation before you can work
with the codebase. There are many excellent tutorials available: start at the
<a class="reference external" href="http://www.git-scm.com/">Git front page</a>.</p>
</div>
<div class="section" id="planning">
<h2>Planning<a class="headerlink" href="#planning" title="Permalink to this headline">¶</a></h2>
<p>We aim to make releases of the TraP at the cadence of a few per year. Broadly,
the plan is to alternate technically focused releases, which clean up the
codebase and make behind-the-scenes improvements, with science based releases,
which provide new functionality to end users. Technical releases have odd
numbers; science releases even. We will provide bugfixes, but no new
development, for the most recent release; support for earlier releases is on a
&#8220;best efforts&#8221; basis only.</p>
<p>At the start of a release cycle, the developers and commissioners will meet to
discuss the issues which will be addressed in the upcoming release. Having
agreed upon a set of goals, a roadmap for the release will be created on the
<a class="reference internal" href="#issue-tracker"><em>Issue Tracker</em></a>.</p>
<p>It is generally acceptable to submit minor changes and tweaks, as well as
bugfixes, to the codebase at any time. However, if you are planning a major
change which will have significant repercussions for other developers, or
which causes end-user visible changes, it should be included in the goals for
a particular release and there should be a broad consensus about the plan for
implementation before you begin coding.</p>
</div>
<div class="section" id="issue-tracker">
<span id="id1"></span><h2>Issue Tracker<a class="headerlink" href="#issue-tracker" title="Permalink to this headline">¶</a></h2>
<p>We keep track of bug reports and feature requests using the <a class="reference external" href="https://support.astron.nl/lofar_issuetracker/projects/bfmise">TraP Project</a> on the <a class="reference external" href="https://support.astron.nl/lofar_issuetracker/">LOFAR
Issue Tracker</a>. You will need
to register for the issue tracker separately with <a class="reference external" href="http://www.astron.nl">ASTRON</a>: see the <a class="reference external" href="http://www.lofar.org/operations/doku.php?id=maintenance:lofar_issue_tracker">LOFAR Wiki</a>
for details.</p>
<p>We use the issue tracker extensively for project planning and managing
releases. It is not a <em>hard</em> requirement that every commit to the repository
refers to a particular issue, but you are strongly encouraged to record your
activities on the tracker and to refer to it in commit messages as
appropriate.</p>
</div>
<div class="section" id="coding-standards">
<h2>Coding Standards<a class="headerlink" href="#coding-standards" title="Permalink to this headline">¶</a></h2>
<p>We do not rigorously enforce a set of coding style rules, with the sole
exception that all indents in Python code should consist of 4 spaces. However,
all code is expected to be considerately written, appropriately (but not
excessively) commented, and as easy to read as possible. Please read <a class="reference external" href="http://www.python.org/dev/peps/pep-0008/">PEP 8</a> carefully and bear it in mind as
you work.</p>
<p>You may wish to run <tt class="docutils literal"><span class="pre">pylint</span></tt> or similar tools on the codebase. Occasionally,
such tools can provide useful hints about how to make your code clearer: by
all means act upon these. However, much of the output of such tools is
subjective: be sure you understand and agree with their recommendations, and
be very reluctant to apply them to pre-existing code without fully considering
the implications.</p>
</div>
<div class="section" id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h2>
<div class="section" id="writing-tests">
<h3>Writing Tests<a class="headerlink" href="#writing-tests" title="Permalink to this headline">¶</a></h3>
<p>The TraP has a moderately-extensive (and constantly expanding!) test suite.
Whenever you make <em>any</em> changes to the code, however minor, you should check
and ensure that all the tests continue to pass. In addition, you should write
new tests to demonstrate the correctness of your changes. In particular:</p>
<ul class="simple">
<li>If you fix a bug, write a test which demonstrates your fix by failing before
your code is committed, and passing afterwards;</li>
<li>If you implement a new feature, write at least one test which demonstrates
the feature in operation and shows how it behaves in likely edge cases (bad
input, etc).</li>
</ul>
<p>When writing new tests, follow the same organization and general style as the
existing test suite.</p>
</div>
<div class="section" id="running-the-tests">
<h3>Running the Tests<a class="headerlink" href="#running-the-tests" title="Permalink to this headline">¶</a></h3>
<p>In order to run the test suite, you will need to download the latest revision
of the test data. This is currently stored in a <a class="reference external" href="http://svn.transientskp.org/data/unittests/tkp_lib/">Subversion repository</a>. Contact
<tt class="docutils literal"><span class="pre">subversion&#64;transientskp.org</span></tt> to request access if necessary. Download the
data to a convenient location on disk and export the <tt class="docutils literal"><span class="pre">TKP_TESTPATH</span></tt>
environment variable to enable the test suite to find it.</p>
<p>Running the full test suite also requires that you have test <a class="reference internal" href="../getstart/concepts/database.html#database-intro"><em>database</em></a> available and initialized. Note that the schema version of
the database must match the version of the TraP you wish to test. An easy way
to configure the database such that it can be access by the test suite is to
export the environment variables <tt class="docutils literal"><span class="pre">TKP_DBENGINE</span></tt>, <tt class="docutils literal"><span class="pre">TKP_DBNAME</span></tt>,
<tt class="docutils literal"><span class="pre">TKP_DBHOST</span></tt>, <tt class="docutils literal"><span class="pre">TKP_DBPORT</span></tt>, <tt class="docutils literal"><span class="pre">TKP_DBUSER</span></tt> and <tt class="docutils literal"><span class="pre">TKP_DBPASSWORD</span></tt>.</p>
<p>You can then run the test suite by invoking <tt class="docutils literal"><span class="pre">runtests.py</span></tt> from within the
<tt class="docutils literal"><span class="pre">tests</span></tt> directory in the repository.</p>
<p>Note that to comprehensively test the pipeline you will need to test against
<em>both</em> the <tt class="docutils literal"><span class="pre">monetdb</span></tt> and <tt class="docutils literal"><span class="pre">postgresql</span></tt> database engines.</p>
</div>
<div class="section" id="continuous-integration">
<h3>Continuous Integration<a class="headerlink" href="#continuous-integration" title="Permalink to this headline">¶</a></h3>
<p>There is a Jenkins instance at <a class="reference external" href="http://jenkins.transientskp.org/">http://jenkins.transientskp.org/</a> which builds
and tests the latest version of the code on the GitHub <tt class="docutils literal"><span class="pre">master</span></tt> branch.
While running the tests locally is essential, please also check Jenkins after
you have made any changes to ensure that the test suite also runs successfully
there.</p>
</div>
</div>
<div class="section" id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<p>Documentation is written using <a class="reference external" href="http://www.sphinx-doc.org/">Sphinx</a>. The
documentation for the <tt class="docutils literal"><span class="pre">HEAD</span></tt> of the <tt class="docutils literal"><span class="pre">master</span></tt> branch of the
<tt class="docutils literal"><span class="pre">transientskp/tkp</span></tt> repository is, together with the documentation for all
released versions, is automatically build every night and put online at
<a class="reference external" href="http://docs.transientskp.org/">http://docs.transientskp.org/</a>.</p>
<p>When implementing a new feature or changing the functionality or organization
of existing features, you <em>must</em> also update the documentation appropriately.</p>
</div>
<div class="section" id="code-review">
<h2>Code Review<a class="headerlink" href="#code-review" title="Permalink to this headline">¶</a></h2>
<p>Rather than pushing changes directly to <tt class="docutils literal"><span class="pre">transientskp/tkp</span></tt>, developers are
asked to submit their changes for review before they are merged into the
project. Ideally, this applies to all changes; however, it is recognized that
in certain cases &#8211; e.g. recovering from a previous mistake, or making trivial
formatting changes &#8211; pushing directly may be appropriate.</p>
<p>Code reviews are carried out using GitHub&#8217;s <a class="reference external" href="https://help.github.com/articles/using-pull-requests">Pull Request</a> functionality.</p>
<div class="section" id="submitting-code-for-review">
<h3>Submitting code for review<a class="headerlink" href="#submitting-code-for-review" title="Permalink to this headline">¶</a></h3>
<p>Using the GitHub web interface, &#8220;fork&#8221; a copy of the repository to your own
account (note that even if you do not have a paid GitHub account, forks of
private repositories remain private, so you are not exposing the code to the
outside world).</p>
<p>Clone a copy of your forked repository to your local system:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git clone git@github.com:&lt;username&gt;/tkp.git
</pre></div>
</div>
<p>Create a branch which you will use for working on your changes:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git checkout -b my_new_branch
</pre></div>
</div>
<p>Work on that branch, editing, adding, removing, etc as required. When you are
finished, push your changes pack to GitHub:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git push orign my_new_branch
</pre></div>
</div>
<p>Return to the GitHub web interface, and issue a pull request to merge your
<tt class="docutils literal"><span class="pre">&lt;username&gt;:my_new_branch</span></tt> into <tt class="docutils literal"><span class="pre">transientskp:master</span></tt>.</p>
</div>
<div class="section" id="reviewing-code">
<h3>Reviewing code<a class="headerlink" href="#reviewing-code" title="Permalink to this headline">¶</a></h3>
<p>Reviewing code is just as valuable an activity as creating it: <em>all</em>
developers are expected to handle a share of code reviews. The procedure is
simple: visit the GitHub web interface, and choose a pull request to review.
Look through it carefully, ensuring that it adheres to the guidelines below.
If you are happy with it, and it can be automatically merged, simply hit the
big green &#8220;Merge Pull Request&#8221;. If an automatic merge isn&#8217;t possible, you will
have to check out the code onto your system and merge it manually: this takes
a little time, but GitHub document the process.</p>
<p>If you <em>aren&#8217;t</em> happy with the code as submitted, you can use the GitHub web
interface to add both general comments covering the whole PR and to comment on
specific lines explaining what the problem is. You can even issue your own PR
suggesting new commits that the submitter could merge with their own work.
Please be as clear as possible and make constructive suggestions as to how the
submitter can make improvements: remember, the aim is to get high quality code
merged into the repository in a timely fashion, not to argue over obscure
minutiae!</p>
</div>
<div class="section" id="requirements-for-pull-requests">
<h3>Requirements for Pull Requests<a class="headerlink" href="#requirements-for-pull-requests" title="Permalink to this headline">¶</a></h3>
<p>When submitting or reviewing a pull request, please bear the following
guidelines in mind:</p>
<ul class="simple">
<li>PRs should be as concise and self-contained as possible. Sometimes, major
functionality changes will require large amounts of code to be changed, but
this should be the exception rather than the rule. Be considerate to the
reviewer and keep changes minimal!</li>
<li>It is not required that reviewers check every line for
correctness, but they should read through the code and check that it is
clearly structured and reasonably transparent in operation.</li>
<li>Effectively all requests should be accompanied by appropriate additions to
the test suite. If it is not possible to provide tests, the submitter should
explain why, and the reviewer must check and agree with this justification.</li>
<li>Any changes to user-visible functionality must be accompanied by appropriate
updates to the Users&#8217; Guide.</li>
<li>Any changes to APIs or the structure of code must be accompanied by
appropriate updates to the Developers&#8217; Reference.</li>
<li>Both submitter and reviewer should check that the PR does not introduce any
regressions into the unit test results (ie, no tests which previously passed
should fail after merging.)</li>
<li>Make sure that the version control history is readable. This means both
using descripive commit messages (future developers will not thank you for
recording that you did &#8220;stuff&#8221;), and appropriate use of <tt class="docutils literal"><span class="pre">git</span> <span class="pre">rebase</span></tt> to
eliminate dead-end and work-in-progress commits before submitting the code
for review.</li>
</ul>
</div>
</div>
<div class="section" id="release-procedure">
<h2>Release procedure<a class="headerlink" href="#release-procedure" title="Permalink to this headline">¶</a></h2>
<div class="section" id="code-and-repository-management">
<h3>Code and repository management<a class="headerlink" href="#code-and-repository-management" title="Permalink to this headline">¶</a></h3>
<p>To make a release you should first create a new branch (if appropriate: see
below), then set the version number in the code, then tag the new release.</p>
<p>Major releases are sequentially numbered (<tt class="docutils literal"><span class="pre">1</span></tt>, <tt class="docutils literal"><span class="pre">2</span></tt>, <tt class="docutils literal"><span class="pre">N</span></tt>). They happen on
a branch named <tt class="docutils literal"><span class="pre">releaseN</span></tt>. Create the branch as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git checkout -b &lt;releaseN&gt;
</pre></div>
</div>
<p>Minor releases happen on existing release branches. They are named <tt class="docutils literal"><span class="pre">N.M</span></tt>,
where <tt class="docutils literal"><span class="pre">N</span></tt> is the major release version and <tt class="docutils literal"><span class="pre">M</span></tt> the minor version. The
first commit on every release branch corresponds to <tt class="docutils literal"><span class="pre">N.0</span></tt>. Check
out the relevant branch:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git checkout &lt;releaseN&gt;
</pre></div>
</div>
<p>Next, edit the code to set the version number. You will need to change the
following files:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">setup.py</span></tt></li>
<li><tt class="docutils literal"><span class="pre">tkp/__init__.py</span></tt></li>
<li><tt class="docutils literal"><span class="pre">documentation/conf.py</span></tt></li>
</ul>
</div></blockquote>
<p>Commit your changes. This commit is the basis of the release:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git commit -am &quot;Release N.M&quot;
</pre></div>
</div>
<p>Tag the release. This is important, as we use the tags to indicate which
versions should be built and added to the documentation site:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git tag -a &quot;rN.M&quot;
</pre></div>
</div>
<p>Push everything, including the tag, to GitHub:</p>
<div class="highlight-python"><div class="highlight"><pre>$ git push --tags origin releaseN
</pre></div>
</div>
</div>
<div class="section" id="local-setup-in-amsterdam">
<h3>Local setup in Amsterdam<a class="headerlink" href="#local-setup-in-amsterdam" title="Permalink to this headline">¶</a></h3>
<p>All tagged releases will be build under <tt class="docutils literal"><span class="pre">/opt/tkp/[tag]</span></tt>. After making &amp;
building a release, <em>manually</em> set <tt class="docutils literal"><span class="pre">/opt/tkp/stable</span></tt> such that it is a
symlink to the latest tag.</p>
<p>Documentation for all tagged releases is built in <tt class="docutils literal"><span class="pre">/srv/TKP-docs/tkp/[tag]</span></tt>
on <tt class="docutils literal"><span class="pre">pc-swinbank</span></tt>. Edit <tt class="docutils literal"><span class="pre">/srv/TKP-docs/index.html</span></tt> such that the
documentation for every released version appears on the website.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/lofar.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Development Procedure</a><ul>
<li><a class="reference internal" href="#accessing-the-code">Accessing the Code</a></li>
<li><a class="reference internal" href="#planning">Planning</a></li>
<li><a class="reference internal" href="#issue-tracker">Issue Tracker</a></li>
<li><a class="reference internal" href="#coding-standards">Coding Standards</a></li>
<li><a class="reference internal" href="#testing">Testing</a><ul>
<li><a class="reference internal" href="#writing-tests">Writing Tests</a></li>
<li><a class="reference internal" href="#running-the-tests">Running the Tests</a></li>
<li><a class="reference internal" href="#continuous-integration">Continuous Integration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
<li><a class="reference internal" href="#code-review">Code Review</a><ul>
<li><a class="reference internal" href="#submitting-code-for-review">Submitting code for review</a></li>
<li><a class="reference internal" href="#reviewing-code">Reviewing code</a></li>
<li><a class="reference internal" href="#requirements-for-pull-requests">Requirements for Pull Requests</a></li>
</ul>
</li>
<li><a class="reference internal" href="#release-procedure">Release procedure</a><ul>
<li><a class="reference internal" href="#code-and-repository-management">Code and repository management</a></li>
<li><a class="reference internal" href="#local-setup-in-amsterdam">Local setup in Amsterdam</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Developer&#8217;s Reference Guide</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="developing.html"
                        title="next chapter">Guidelines for Developers</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/devref/procedure.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="developing.html" title="Guidelines for Developers"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Developer’s Reference Guide"
             >previous</a> |</li>
        <li><a href="../index.html">LOFAR Transients Pipeline 2.0-pre documentation</a> &raquo;</li>
          <li><a href="index.html" >Developer&#8217;s Reference Guide</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011—2014, LOFAR Transients Key Science Project.
    </div>
  </body>
</html>