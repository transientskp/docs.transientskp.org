<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>tkp.sourcefinder.image – Image class &amp; routines &mdash; LOFAR Transients Pipeline 2.0-pre documentation</title>
    
    <link rel="stylesheet" href="../../../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2.0-pre',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../_static/lofar.ico"/>
    <link rel="top" title="LOFAR Transients Pipeline 2.0-pre documentation" href="../../../index.html" />
    <link rel="up" title="Sourcefinder package" href="index.html" />
    <link rel="next" title="tkp.sourcefinder.extract – Source extraction routines" href="extract.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="extract.html" title="tkp.sourcefinder.extract – Source extraction routines"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introduction"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../index.html">LOFAR Transients Pipeline 2.0-pre documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Developer&#8217;s Reference Guide</a> &raquo;</li>
          <li><a href="../index.html" >Library &amp; API</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Sourcefinder package</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tkp-sourcefinder-image-image-class-routines">
<span id="sourcefinder-image"></span><h1><a class="reference internal" href="#module-tkp.sourcefinder.image" title="tkp.sourcefinder.image: Sourcefinder Image class and routines for simple image handling"><tt class="xref py py-mod docutils literal"><span class="pre">tkp.sourcefinder.image</span></tt></a> &#8211; Image class &amp; routines<a class="headerlink" href="#tkp-sourcefinder-image-image-class-routines" title="Permalink to this headline">¶</a></h1>
<p>This module provides simple access to an image, without database
overhead. The Image class handles the actual data (a (2D) numpy
array), the world coordinate system (a tkp.utility.coordinates.WCS
instance) and the beam information. While these three objects are
supplied upon instantiation of an Image, one can use a
<tt class="xref py py-class docutils literal"><span class="pre">tkp.accessors.DataAccessor</span></tt> object to automatically
derive these from the image file itself (provided the header
information in the file is correct).</p>
<span class="target" id="module-tkp.sourcefinder.image"></span><dl class="docutils">
<dt>Some generic utility routines for number handling and</dt>
<dd>calculating (specific) variances</dd>
</dl>
<dl class="class">
<dt id="tkp.sourcefinder.image.ImageData">
<em class="property">class </em><tt class="descclassname">tkp.sourcefinder.image.</tt><tt class="descname">ImageData</tt><big>(</big><em>data</em>, <em>beam</em>, <em>wcs</em>, <em>margin=0</em>, <em>radius=0</em>, <em>back_size_x=32</em>, <em>back_size_y=32</em>, <em>residuals=True</em><big>)</big><a class="reference internal" href="../../../_modules/tkp/sourcefinder/image.html#ImageData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.sourcefinder.image.ImageData" title="Permalink to this definition">¶</a></dt>
<dd><p>Encapsulates an image in terms of a numpy array + meta/headerdata.</p>
<p>This is your primary contact point for interaction with images: it icludes
facilities for source extraction and measurement, etc.</p>
<p>Sets up an ImageData object.</p>
<dl class="docutils">
<dt><em>Args:</em></dt>
<dd><ul class="first last simple">
<li>data (2D numpy.ndarray): actual image data</li>
<li>wcs (utility.coordinates.wcs): world coordinate system
specification</li>
<li>beam (3-tuple): beam shape specification as
(semimajor, semiminor, theta)</li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="tkp.sourcefinder.image.ImageData.backmap">
<tt class="descname">backmap</tt><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.backmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Background map</p>
</dd></dl>

<dl class="staticmethod">
<dt id="tkp.sourcefinder.image.ImageData.box_slice_about_pixel">
<em class="property">static </em><tt class="descname">box_slice_about_pixel</tt><big>(</big><em>x</em>, <em>y</em>, <em>box_radius</em><big>)</big><a class="reference internal" href="../../../_modules/tkp/sourcefinder/image.html#ImageData.box_slice_about_pixel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.box_slice_about_pixel" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a slice centred about (x,y), of width = 2*int(box_radius) + 1</p>
</dd></dl>

<dl class="method">
<dt id="tkp.sourcefinder.image.ImageData.clearcache">
<tt class="descname">clearcache</tt><big>(</big><big>)</big><a class="reference internal" href="../../../_modules/tkp/sourcefinder/image.html#ImageData.clearcache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.clearcache" title="Permalink to this definition">¶</a></dt>
<dd><p>Zap any calculated data stored in this object.</p>
<p>Clear the background and rms maps, labels, clip, and any locally held
data. All of these can be reconstructed from the data accessor.</p>
<p>Note that this <em>must</em> be run to pick up any new settings.</p>
</dd></dl>

<dl class="attribute">
<dt id="tkp.sourcefinder.image.ImageData.data">
<tt class="descname">data</tt><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Masked image data</p>
</dd></dl>

<dl class="attribute">
<dt id="tkp.sourcefinder.image.ImageData.data_bgsubbed">
<tt class="descname">data_bgsubbed</tt><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.data_bgsubbed" title="Permalink to this definition">¶</a></dt>
<dd><p>Background subtracted masked image data</p>
</dd></dl>

<dl class="method">
<dt id="tkp.sourcefinder.image.ImageData.extract">
<tt class="descname">extract</tt><big>(</big><em>det</em>, <em>anl</em>, <em>noisemap=None</em>, <em>bgmap=None</em>, <em>labelled_data=None</em>, <em>labels=None</em>, <em>deblend_nthresh=0</em>, <em>force_beam=False</em><big>)</big><a class="reference internal" href="../../../_modules/tkp/sourcefinder/image.html#ImageData.extract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.extract" title="Permalink to this definition">¶</a></dt>
<dd><p>Kick off conventional (ie, RMS island finding) source extraction.</p>
<p>Kwargs:</p>
<blockquote>
<div><dl class="docutils">
<dt>det (float): detection threshold, as a multiple of the RMS</dt>
<dd>noise. At least one pixel in a source must exceed this
for it to be regarded as significant.</dd>
<dt>anl (float): analysis threshold, as a multiple of the RMS</dt>
<dd>noise. All the pixels within the island that exceed
this will be used when fitting the source.</dd>
</dl>
<p>noisemap (numpy.ndarray):</p>
<p>bgmap (numpy.ndarray):</p>
<dl class="docutils">
<dt>deblend_nthresh (int): number of subthresholds to use for</dt>
<dd>deblending. Set to 0 to disable.</dd>
<dt>force_beam (bool): force all extractions to have major/minor axes</dt>
<dd>equal to the restoring beam</dd>
</dl>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">(..utility.containers.ExtractionResults):</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="tkp.sourcefinder.image.ImageData.fd_extract">
<tt class="descname">fd_extract</tt><big>(</big><em>alpha</em>, <em>anl=None</em>, <em>noisemap=None</em>, <em>bgmap=None</em>, <em>deblend_nthresh=0</em>, <em>force_beam=False</em><big>)</big><a class="reference internal" href="../../../_modules/tkp/sourcefinder/image.html#ImageData.fd_extract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.fd_extract" title="Permalink to this definition">¶</a></dt>
<dd><p>False Detection Rate based source extraction.
The FDR procedure guarantees that &lt;FDR&gt; &lt; alpha.</p>
<p>See <a class="reference external" href="http://adsabs.harvard.edu/abs/2002AJ....123.1086H">Hopkins et al., AJ, 123, 1086 (2002)</a>.</p>
</dd></dl>

<dl class="method">
<dt id="tkp.sourcefinder.image.ImageData.fit_fixed_positions">
<tt class="descname">fit_fixed_positions</tt><big>(</big><em>sources</em>, <em>boxsize</em>, <em>threshold=None</em>, <em>fixed='position+shape'</em><big>)</big><a class="reference internal" href="../../../_modules/tkp/sourcefinder/image.html#ImageData.fit_fixed_positions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.fit_fixed_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to fit a list of sources at the given positions</p>
<p>This function wraps around fit_to_point().</p>
<p>Sources is a list of (ra, dec) tuples (not pixel coordinates).</p>
<p>All other arguments are the same as in fit_to_point(). In
particular, boxsize is in pixel coordinates as in
fit_to_point, not in sky coordinates.</p>
</dd></dl>

<dl class="method">
<dt id="tkp.sourcefinder.image.ImageData.fit_to_point">
<tt class="descname">fit_to_point</tt><big>(</big><em>x</em>, <em>y</em>, <em>boxsize</em>, <em>threshold</em>, <em>fixed</em><big>)</big><a class="reference internal" href="../../../_modules/tkp/sourcefinder/image.html#ImageData.fit_to_point"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.fit_to_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit an elliptical Gaussian to a specified point on the image.</p>
<p>The fit is carried on a square section of the image, of length
<em>boxsize</em> &amp; centred at pixel coordinates <em>x</em>, <em>y</em>. Any data
below <em>threshold</em> * rmsmap is not used for fitting. If <em>fixed</em>
is set to <tt class="docutils literal"><span class="pre">position</span></tt>, then the pixel coordinates are fixed
in the fit.</p>
<p>Returns an instance of <a class="reference internal" href="extract.html#tkp.sourcefinder.extract.Detection" title="tkp.sourcefinder.extract.Detection"><tt class="xref py py-class docutils literal"><span class="pre">tkp.sourcefinder.extract.Detection</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="tkp.sourcefinder.image.ImageData.flux_at_pixel">
<tt class="descname">flux_at_pixel</tt><big>(</big><em>x</em>, <em>y</em>, <em>numpix=1</em><big>)</big><a class="reference internal" href="../../../_modules/tkp/sourcefinder/image.html#ImageData.flux_at_pixel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.flux_at_pixel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the background-subtracted flux at a certain position
in the map</p>
</dd></dl>

<dl class="attribute">
<dt id="tkp.sourcefinder.image.ImageData.grids">
<tt class="descname">grids</tt><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.grids" title="Permalink to this definition">¶</a></dt>
<dd><p>Gridded RMS and background data for interpolating</p>
</dd></dl>

<dl class="method">
<dt id="tkp.sourcefinder.image.ImageData.label_islands">
<tt class="descname">label_islands</tt><big>(</big><em>detectionthresholdmap</em>, <em>analysisthresholdmap</em><big>)</big><a class="reference internal" href="../../../_modules/tkp/sourcefinder/image.html#ImageData.label_islands"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.label_islands" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a lablled array of pixels for fitting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of valid islands (list of int)<p>labelled islands (numpy.ndarray)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="tkp.sourcefinder.image.ImageData.pixmax">
<tt class="descname">pixmax</tt><a class="reference internal" href="../../../_modules/tkp/sourcefinder/image.html#ImageData.pixmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.pixmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum pixel value (pre-background subtraction)</p>
</dd></dl>

<dl class="attribute">
<dt id="tkp.sourcefinder.image.ImageData.pixmin">
<tt class="descname">pixmin</tt><a class="reference internal" href="../../../_modules/tkp/sourcefinder/image.html#ImageData.pixmin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.pixmin" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum pixel value (pre-background subtraction)</p>
</dd></dl>

<dl class="method">
<dt id="tkp.sourcefinder.image.ImageData.reverse_se">
<tt class="descname">reverse_se</tt><big>(</big><em>det</em><big>)</big><a class="reference internal" href="../../../_modules/tkp/sourcefinder/image.html#ImageData.reverse_se"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.reverse_se" title="Permalink to this definition">¶</a></dt>
<dd><p>Run source extraction on the negative of this image.</p>
<p>Obviously, there should be no sources in the negative image, so this
tells you about the false positive rate.</p>
<p>We need to clear cached data &#8211; backgroung map, cached clips, etc &#8211;
before &amp; after doing this, as they&#8217;ll interfere with the normal
extraction process. If this is regularly used, we&#8217;ll want to
implement a separate cache.</p>
</dd></dl>

<dl class="attribute">
<dt id="tkp.sourcefinder.image.ImageData.rmsmap">
<tt class="descname">rmsmap</tt><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.rmsmap" title="Permalink to this definition">¶</a></dt>
<dd><p>RMS map</p>
</dd></dl>

<dl class="attribute">
<dt id="tkp.sourcefinder.image.ImageData.xdim">
<tt class="descname">xdim</tt><a class="reference internal" href="../../../_modules/tkp/sourcefinder/image.html#ImageData.xdim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.xdim" title="Permalink to this definition">¶</a></dt>
<dd><p>X pixel dimension of (unmasked) data</p>
</dd></dl>

<dl class="attribute">
<dt id="tkp.sourcefinder.image.ImageData.ydim">
<tt class="descname">ydim</tt><a class="reference internal" href="../../../_modules/tkp/sourcefinder/image.html#ImageData.ydim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.sourcefinder.image.ImageData.ydim" title="Permalink to this definition">¶</a></dt>
<dd><p>Y pixel dimension of (unmasked) data</p>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/lofar.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="introduction.html"
                        title="previous chapter">Introduction</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="extract.html"
                        title="next chapter"><tt class="docutils literal"><span class="pre">tkp.sourcefinder.extract</span></tt> &#8211; Source extraction routines</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../../_sources/devref/tkp/sourcefinder/image.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="extract.html" title="tkp.sourcefinder.extract – Source extraction routines"
             >next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introduction"
             >previous</a> |</li>
        <li><a href="../../../index.html">LOFAR Transients Pipeline 2.0-pre documentation</a> &raquo;</li>
          <li><a href="../../index.html" >Developer&#8217;s Reference Guide</a> &raquo;</li>
          <li><a href="../index.html" >Library &amp; API</a> &raquo;</li>
          <li><a href="index.html" >Sourcefinder package</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011—2014, LOFAR Transients Key Science Project.
    </div>
  </body>
</html>