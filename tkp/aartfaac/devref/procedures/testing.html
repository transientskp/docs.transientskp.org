<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Testing &amp; Continuous Integration &mdash; LOFAR Transients Pipeline 2.1-pre documentation</title>
    
    <link rel="stylesheet" href="../../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.1-pre',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/lofar.ico"/>
    <link rel="top" title="LOFAR Transients Pipeline 2.1-pre documentation" href="../../index.html" />
    <link rel="up" title="Development Procedure" href="index.html" />
    <link rel="next" title="Documentation" href="doc.html" />
    <link rel="prev" title="Accessing the Code" href="basics.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="doc.html" title="Documentation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="basics.html" title="Accessing the Code"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">LOFAR Transients Pipeline 2.1-pre documentation</a> &raquo;</li>
          <li><a href="../index.html" >Developer&#8217;s Reference Guide</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Development Procedure</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="testing-continuous-integration">
<span id="testing"></span><h1>Testing &amp; Continuous Integration<a class="headerlink" href="#testing-continuous-integration" title="Permalink to this headline">¶</a></h1>
<p>The <tt class="docutils literal"><span class="pre">tests</span></tt> directory contains a (reasonably) comprehensive TraP test suite.
Tests are written following the <a class="reference external" href="https://docs.python.org/2/library/unittest.html">Python unittest</a> conventions. Although they
can be run using just the standard Python library tools, you might find that
<a class="reference external" href="https://nose.readthedocs.org/en/latest/">nose</a> provides a more convenient
interface.</p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>Whenever any changes are made to the code, all pre-extant tests <em>must</em>
continue to pass. If the change involves changing the result of one or more
tests, any such changes must be clearly explained and check during
<a class="reference internal" href="review.html#code-review"><em>Code Review</em></a>.</p>
<p>New features and bug fixes must be accompanied by appropriate tests. These
should both demonstrate the correct operation of the code with good input data
as well as demonstrating how it responds to bad inputs. Again, the code
reviewer should check that the tests provided are clear and comprehensive.</p>
</div>
<div class="section" id="test-data">
<h2>Test data<a class="headerlink" href="#test-data" title="Permalink to this headline">¶</a></h2>
<p>Many of the tests require data files which are distributed separately from the
TraP. Having cloned the TraP repository (into the directory <tt class="docutils literal"><span class="pre">tkp</span></tt> in this
example), fetch the appropriate test data as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>$ cd tkp
$ git submodule init
$ git submodule update
</pre></div>
</div>
<p>In future, running <tt class="docutils literal"><span class="pre">git</span> <span class="pre">submodule</span> <span class="pre">update</span></tt> again will fetch the latest
version of the test data if required.</p>
<p>By default, the test suite will look for data in the appropriate subdirectory
of your checked out Trap source. However, if the data has been installed
elsewhere, or if you are running the test suite against an installed copy of
the TraP, you can specify the data location by exporting the <tt class="docutils literal"><span class="pre">TKP_TESTPATH</span></tt>
environment variable.</p>
<p>If the data is not available, the relevant tests will be skipped. The partial
test suite should still complete successfully; note that your copy of the TraP
will not be fully tested.</p>
</div>
<div class="section" id="database">
<h2>Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h2>
<p>Many of the tests require interaction with the <a class="reference internal" href="../../getstart/concepts/database.html#database-intro"><em>pipeline database</em></a>. A convient way to configure the database is by using
environment variables. For example:</p>
<div class="highlight-python"><div class="highlight"><pre>$ export TKP_DBENGINE=xxx
$ export TKP_DBNAME=xxx
$ export TKP_DBHOST=xxx
$ export TKP_DBPORT=xxx
$ export TKP_DBUSER=xxx
$ export TKP_DBPASSWORD=xxx
$ trap-manage.py initdb
</pre></div>
</div>
<p>If you do not have or need a database, you can disable all the tests which
require it by exporting the variable <tt class="docutils literal"><span class="pre">TKP_DISABLEDB</span></tt>. The partial test suite
should still complete successfully, but your copy of the TraP will not be
fully tested.</p>
</div>
<div class="section" id="running-the-tests">
<h2>Running the tests<a class="headerlink" href="#running-the-tests" title="Permalink to this headline">¶</a></h2>
<p>Within the <tt class="docutils literal"><span class="pre">tests</span></tt> directory, use the <tt class="docutils literal"><span class="pre">runtests.py</span></tt> script to start the
test suite using <tt class="docutils literal"><span class="pre">nose</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>$ cd tests
$ python runtests.py -v
</pre></div>
</div>
<p>Command line arguments (such as <tt class="docutils literal"><span class="pre">-v</span></tt>, above) are passed onwards to <tt class="docutils literal"><span class="pre">nose</span></tt>;
you can use them, for example, to select a particular subset of the suite to
run.</p>
<p>Often it is convenient to run the TraP against a work-in-progress version of
the TraP while continuing to use other libraries and tools installed on the
system. This just requires setting the <tt class="docutils literal"><span class="pre">PYTHONPATH</span></tt> environment variable to
the root of the development tree:</p>
<div class="highlight-python"><div class="highlight"><pre>$ cd tkp
$ export PYTHONPATH=$(pwd):${PYTHONPATH}
$ cd tests
$ python runtests.py -v
</pre></div>
</div>
<p>Alternatively, you may choose to work with a <a class="reference external" href="http://virtualenv.readthedocs.org/en/latest/">virtualenv</a> and install the
TraP in &#8216;development mode&#8217;:</p>
<div class="highlight-python"><div class="highlight"><pre>$ pip install --editable .
</pre></div>
</div>
</div>
<div class="section" id="continuous-integration">
<h2>Continuous integration<a class="headerlink" href="#continuous-integration" title="Permalink to this headline">¶</a></h2>
<p>There is a Jenkins instance at <a class="reference external" href="https://jenkins.transientskp.org/">https://jenkins.transientskp.org/</a> which builds
and tests all code committed to the <tt class="docutils literal"><span class="pre">master</span></tt> branch as well as any incoming
pull requests. This constitutes the reference system on which tests are
required to pass: a failure here should result in a change being rejected,
regardless of its successful operation on some other system.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/lofar.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Testing &amp; Continuous Integration</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#test-data">Test data</a></li>
<li><a class="reference internal" href="#database">Database</a></li>
<li><a class="reference internal" href="#running-the-tests">Running the tests</a></li>
<li><a class="reference internal" href="#continuous-integration">Continuous integration</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="basics.html"
                        title="previous chapter">Accessing the Code</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="doc.html"
                        title="next chapter">Documentation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/devref/procedures/testing.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="doc.html" title="Documentation"
             >next</a> |</li>
        <li class="right" >
          <a href="basics.html" title="Accessing the Code"
             >previous</a> |</li>
        <li><a href="../../index.html">LOFAR Transients Pipeline 2.1-pre documentation</a> &raquo;</li>
          <li><a href="../index.html" >Developer&#8217;s Reference Guide</a> &raquo;</li>
          <li><a href="index.html" >Development Procedure</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2006—2015, LOFAR Transients Key Science Project.
    </div>
  </body>
</html>