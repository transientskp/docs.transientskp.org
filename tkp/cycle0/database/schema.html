

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Schema &mdash; LOFAR Transients Tools Release 0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'Release 0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="LOFAR Transients Tools Release 0 documentation" href="../index.html" />
    <link rel="up" title="The TKP Database" href="index.html" />
    <link rel="next" title="Source Association" href="assoc.html" />
    <link rel="prev" title="Database" href="intro.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="assoc.html" title="Source Association"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Database"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">LOFAR Transients Tools Release 0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">The TKP Database</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="schema">
<span id="database-schema"></span><h1>Schema<a class="headerlink" href="#schema" title="Permalink to this headline">¶</a></h1>
<img alt="../_images/schema.png" src="../_images/schema.png" />
<div class="section" id="assoccatsource">
<h2>assoccatsource<a class="headerlink" href="#assoccatsource" title="Permalink to this headline">¶</a></h2>
<p>This table stores the association between an extracted source and one or more
cataloged sources (i.e. VLSS, WENSSm, WENSSp, and NVSS sources).</p>
<p>For every association pair the association parameters, distance_arcsec, r and
loglr are calculated as well. Only source pairs that fullfil the criterion of
an association (<span class="math">\(r &lt; r_{lim}\)</span>) are accepted and appended to this table.
<span class="math">\(r_{lim}\)</span> may be specified in the user parsets or tkp.cfg, otherwise it
defaults to 3.717, corresponding to missing <span class="math">\(10^{-3}\)</span> counterparts (see
<a class="reference external" href="http://dare.uva.nl/en/record/367374">Scheers&#8217;s thesis</a>, section 3.2.3)</p>
<dl class="docutils">
<dt><strong>xrtsrc</strong></dt>
<dd>This refers to the xtrsrcid of the extractedsource</dd>
<dt><strong>catsrc</strong></dt>
<dd>This is the id of the catalogedsource that could be associated to the
extractedsource as its counterpart</dd>
<dt><strong>type</strong></dt>
<dd>Type of the association, determined by the association procedure inside the
database. See under assocxtrsource for types and their descriptions</dd>
<dt><strong>distance_arcsec</strong></dt>
<dd>The distance in arcsec between the associated sources, calculated by the
database using the dot product and Cartesian coordinates</dd>
<dt><strong>r</strong></dt>
<dd>The dimensionless distance (De Ruiter radius) between the associated
sources. It is determined as the positional differences weighted by the
errors, calculated by the association procedure inside the database (Scheers
thesis ch3).</dd>
<dt><strong>loglr</strong></dt>
<dd>The logarithm of the likelihood ratio of the associated sources, defaults to
NULL if not calculated (Scheers thesis ch3).</dd>
</dl>
</div>
<div class="section" id="assocxtrsource">
<h2>assocxtrsource<a class="headerlink" href="#assocxtrsource" title="Permalink to this headline">¶</a></h2>
<p>This table stores the association between an extracted source and its
runningcatalog counterpart source, where the relation might be of type 1-1, 1-n
or n-1.</p>
<dl class="docutils">
<dt><strong>runcat</strong></dt>
<dd>refers to the runcatid in runningcatalog.  It is considered as the &#8220;base&#8221; id
of a lightcurve, whereas the lightcurve consist of multiple frequency bands
and Stokes parameters.</dd>
<dt><strong>xtrsrc</strong></dt>
<dd>This is the id of the extracted source that could be associated to
runningcatalog source.  Together, the runcat_id and the xtrsrc form a unique
pair.</dd>
<dt><strong>type</strong></dt>
<dd>Type of association, and its description.  n-m, where n is the number of
runningcatalog sources, and m the number of extractedsources.
Type 1: 1-1 association; type 2: 1-n (one-to-many) association; type 3:
n-1, many-to-one association; type 4: n-m (many-to-many) association; type
5: 0-1 (zero-to-one) association, a new source.</dd>
<dt><strong>distance_arcsec</strong></dt>
<dd>The distance in arcsec between the associated sources, calculated by the
database using the dot product Cartesian coordinates</dd>
<dt><strong>r</strong></dt>
<dd>The dimensionless distance (De Ruiter radius) between the associated
sources. It is determined as the positional differences weighted by the
errors, calculated by the association procedure inside the database (Scheers
thesis chapter 3).</dd>
<dt><strong>loglr</strong></dt>
<dd>The logarithm of the likelihood ratio of the associated sources, defaults to
NULL if not calculated (Scheers thesis ch3).</dd>
</dl>
</div>
<div class="section" id="catalogedsource">
<h2>catalogedsource<a class="headerlink" href="#catalogedsource" title="Permalink to this headline">¶</a></h2>
<p>This table contains the sources from renown surveys/catalogues, VLSS, WENSS
and NVSS. The original data (all columns) are downloaded from the CDS Vizier
websites (<a class="reference external" href="http://cdsarc.u-strasbg.fr/viz-bin/VizieR?-source=VIII/79">VLSS</a>,
<a class="reference external" href="http://cdsarc.u-strasbg.fr/viz-bin/VizieR?-source=VIII/62">WENSS</a> and <a class="reference external" href="http://cdsarc.u-strasbg.fr/viz-bin/VizieR?-source=VIII/65">NVSS</a>) The catalogues
also contains the exoplanets, of which the entries were provided by
Jean-Mathias Griessmeier.</p>
<p>This table will be pre-loaded in the database, in order to have it available
all the time. As opposed to the runningcatalog, the catalogedsources table is
static and fixed and won&#8217;t change during runs.</p>
<dl class="docutils">
<dt><strong>id</strong></dt>
<dd>Every inserted catalog source gets a unique id, generated sequentially by
the database.</dd>
<dt><strong>catalog</strong></dt>
<dd>The reference id to the catalog from which this source originates from.</dd>
<dt><strong>orig_catsrcid</strong></dt>
<dd>The original id of the source as reported in the catalog</dd>
<dt><strong>catsrcname</strong></dt>
<dd>The original name of the source as reported in the catalog</dd>
<dt><strong>tau</strong></dt>
<dd>The integration time. Defaults to NULL.</dd>
<dt><strong>band</strong></dt>
<dd>The reference id to the frequencyband at which this survey was carried out.</dd>
<dt><strong>stokes</strong></dt>
<dd>The Stokes parameter. Four possible values 1 - I, 2 - Q, 3 - U, 4 - V.
(Currently the external catalogues only report the Stokes I values).</dd>
<dt><strong>freq_eff</strong></dt>
<dd>The effective frequency (in Hz) of the survey, as reported in the catalog</dd>
<dt><strong>zone</strong></dt>
<dd>The zone id in which the source declination resides, calculated by the
database.  The sphere is devided into zones of equal width: currently
fixed to 1 degree, and the zone is effectively the truncated declination.
(<tt class="docutils literal"><span class="pre">decl</span></tt> = 31.3 → <tt class="docutils literal"><span class="pre">zone</span></tt> = 31, <tt class="docutils literal"><span class="pre">decl</span></tt> = 31.9 → <tt class="docutils literal"><span class="pre">zone</span></tt> = 31). This
column is primarly for speeding up source look-up queries.</dd>
<dt><strong>ra</strong></dt>
<dd>The right ascension (RA) of the source in J2000 degrees.</dd>
<dt><strong>decl</strong></dt>
<dd>The declination (decl) of the source in J2000 degrees.</dd>
<dt><strong>ra_err</strong></dt>
<dd>The 1-sigma error of the source in RA as measured on the sky, in arcsec.</dd>
<dt><strong>decl_err</strong></dt>
<dd>The 1-sigma error of the source in decl as measured on the sky, in arcsec.</dd>
<dt><strong>x</strong></dt>
<dd>The x-Cartesian coordinate of the source, generated by the database from
<tt class="docutils literal"><span class="pre">ra</span></tt>, <tt class="docutils literal"><span class="pre">decl</span></tt>: <span class="math">\(\cos(decl) * \cos(ra)\)</span>.</dd>
<dt><strong>y</strong></dt>
<dd>The y-Cartesian coordinate of the source, generated by the database from
<tt class="docutils literal"><span class="pre">ra</span></tt>, <tt class="docutils literal"><span class="pre">decl</span></tt>: <span class="math">\(\cos(decl) * \sin(ra)\)</span>.</dd>
<dt><strong>z</strong></dt>
<dd>The z-Cartesian coordinate of the source, generated by the database from
<tt class="docutils literal"><span class="pre">ra</span></tt>, <tt class="docutils literal"><span class="pre">decl</span></tt>: <span class="math">\(\sin(decl)\)</span>.</dd>
<dt><strong>margin</strong></dt>
<dd>Not used, defaults to 0.</dd>
<dt><strong>det_sigma</strong></dt>
<dd>The detection level of the source, which none of the current catalogs
provides, and defaults to 0.</dd>
<dt><strong>src_type</strong></dt>
<dd>Only the WENSS catalog reports the source type: M for a multi-component
source, C for a subcomponent of the parent M, S for a single source and E
for an extended source. Currently, we associate extracted sources with all
source types.</dd>
<dt><strong>fit_probl</strong></dt>
<dd>WENSS and NVSS report occasional fit problems.</dd>
<dt><strong>PA</strong></dt>
<dd>Position angle of fitted major axis, in degrees</dd>
<dt><strong>PA_err</strong></dt>
<dd>Error on position angle of fitted major axis, in degrees</dd>
<dt><strong>major</strong></dt>
<dd>Major axis of deconvolved component size, in arcsec</dd>
<dt><strong>major_err</strong></dt>
<dd>Mean error on major axis, in arcsec</dd>
<dt><strong>minor</strong></dt>
<dd>Minor axis of deconvolved component size, in arcsec</dd>
<dt><strong>minor_err</strong></dt>
<dd>Mean error on minor axis, in arcsec</dd>
<dt><strong>avg_f_peak</strong></dt>
<dd>Peak flux (in Jy) of source. It is prefixed by avg, since its value is
based on a number of observations, as will also be the case when we add
LOFAR surveys (MSSS) to this table.</dd>
<dt><strong>avg_f_peak_err</strong></dt>
<dd>Mean error on peak flux of source, in Jy</dd>
<dt><strong>avg_f_int</strong></dt>
<dd>Integrated flux of source, in Jy</dd>
<dt><strong>avg_f_int_err</strong></dt>
<dd>Mean error on integrated flux of source, in Jy</dd>
<dt><strong>frame</strong></dt>
<dd>Some catalogs have a reference to a frame/fits image/jpg postage stamp for
the field the source was detected in.</dd>
</dl>
</div>
<div class="section" id="catalog">
<h2>catalog<a class="headerlink" href="#catalog" title="Permalink to this headline">¶</a></h2>
<p>This table stores the information about the catalogs that are loaded into the
pipeline database.</p>
<dl class="docutils">
<dt><strong>id</strong></dt>
<dd>Every catalog gets a unique id, generated sequentually by the database.</dd>
<dt><strong>name</strong></dt>
<dd>An acronym under which the catalog is well-known, e.g. &#8216;NVSS&#8217;</dd>
<dt><strong>fullname</strong></dt>
<dd>The (nearly) full name under which the catalog is known, e.g. &#8216;NRAO VLA
Sky Survey&#8217;</dd>
</dl>
</div>
<div class="section" id="classification">
<h2>classification<a class="headerlink" href="#classification" title="Permalink to this headline">¶</a></h2>
<p>This table contains classification of transients</p>
</div>
<div class="section" id="dataset">
<h2>dataset<a class="headerlink" href="#dataset" title="Permalink to this headline">¶</a></h2>
<p>This table contains the information about a dataset. A dataset is nothing more
than a collection of images grouped together for processing. When the same
group is reprocessed, and the dataset.inname is identical (e.g. when the
processing runs with other trap parameters), the rerun is incremented by 1, but
the id is auto-incremented as well, treating it as an independent dataset.</p>
<dl class="docutils">
<dt><strong>id</strong></dt>
<dd>Every dataset gets a unique id. The id is generated by the database.</dd>
<dt><strong>rerun</strong></dt>
<dd>The value indicates how many times a dataset with a given description was
processed by the pipeline. Note that every dataset still has a unique id,
even when it was reprocessed.
At insertion time, by the insertDataset() SQL function, this is incremented
by 1 when the description of the dataset is already present in the table,
otherwise defaults to 0.</dd>
<dt><strong>type</strong></dt>
<dd>Not being used.</dd>
<dt><strong>process_ts</strong></dt>
<dd>The timestamp of the start of processing the dataset, generated by the
database.</dd>
<dt><strong>detection_threshold</strong></dt>
<dd>The detection threshold that was used by source finder to extract sources.
Value read from either the source finder parset file or the tkp.cfg file.
See the <a class="reference internal" href="../tools/pyse.html#pyse"><em>PySE documentation</em></a> for more information.</dd>
<dt><strong>analysis_threshold</strong></dt>
<dd>The analysis threshold that was used by source finder to extract sources.
Value read from either the source finder parset file or the tkp.cfg file.
See the <a class="reference internal" href="../tools/pyse.html#pyse"><em>PySE documentation</em></a> for more information.</dd>
<dt><strong>assoc_radius</strong></dt>
<dd>The association radius that is being used for associating sources. Value
read from either the source finder parset file or the tkp.cfg file.</dd>
<dt><strong>backsize_x</strong></dt>
<dd>Background grid segment size in x. Value read from either the source finder
parset file or the tkp.cfg file. See the <a class="reference internal" href="../tools/pyse.html#pyse"><em>PySE documentation</em></a>
for more information.</dd>
<dt><strong>backsize_y</strong></dt>
<dd>Background grid segment size in y. Value read from either the source finder
parset file or the tkp.cfg file. See the <a class="reference internal" href="../tools/pyse.html#pyse"><em>PySE documentation</em></a>
for more information.</dd>
<dt><strong>margin_width</strong></dt>
<dd>Margin applied to each edge of image (in pixels). Value read from either
the source finder parset file or the tkp.cfg file. See the <a class="reference internal" href="../tools/pyse.html#pyse"><em>PySE
documentation</em></a> for more information.</dd>
<dt><strong>description</strong></dt>
<dd>A description of the dataset, with a maximum of 100 characters.</dd>
<dt><strong>node(s)</strong></dt>
<dd>Determine the current and number of nodes in case of a sharded database
set-up.</dd>
</dl>
</div>
<div class="section" id="extractedsource">
<h2>extractedsource<a class="headerlink" href="#extractedsource" title="Permalink to this headline">¶</a></h2>
<p>This table contains all the extracted sources (measurements) of an image.
Maybe source is not the right description, because measurements may be made
that were erronous and do not represent a source.</p>
<p>Most values come from the sourcefinder procedures, and some are auxiliary
deduced values generated by the database.</p>
<p>This table is empty <em>before</em> an observation. <em>During</em> an observation new
sources are inserted into this table. <em>After</em> an observation this table is
dumped and transported to the catalog database.</p>
<p>All detections (measurements) found by sourcefinder are appended to this table.
At insertion time some additional auxiliary parameters are calculated by the
database as well. At anytime, no entries will be deleted or updated.
The TraP may add forced-fit entries to this table as well. Then
<tt class="docutils literal"><span class="pre">extract_type</span></tt> is set to 1.</p>
<dl class="docutils">
<dt><strong>id</strong></dt>
<dd>Every inserted source/measurement gets a unique id, generated by the
database.</dd>
<dt><strong>image</strong></dt>
<dd>The reference id to the image from which this sources was extracted.</dd>
<dt><strong>zone</strong></dt>
<dd>The zone id in which the source declination resides, calculated by the
database.  The sphere is devided into zones of equal width: currently fixed
to 1 degree, and the zone is effectively the truncated declination.
(decl=31.3 =&gt; zone=31, decl=31.9 =&gt; zone=31). This column is primarly for
speeding up source look-up queries.</dd>
<dt><strong>ra</strong></dt>
<dd>Right ascension of the measurement [in J2000 degrees], calculated by the
sourcefinder procedures.</dd>
<dt><strong>decl</strong></dt>
<dd>Declination of the measurement [in J2000 degrees], calculated by the
sourcefinder procedures.</dd>
<dt><strong>ra_err</strong></dt>
<dd>The 1-sigma error on ra [in arcsec], the square root of the quadratic sum of the
gaussian fit and systematic errors, calculated by the database at insertion time.</dd>
<dt><strong>decl_err</strong></dt>
<dd>The 1-sigma error on declination [in arcsec],
the square root of the quadratic sum of the gaussian fit and systematic errors,
calculated by the database at insertion time.</dd>
<dt><strong>ra_fit_err</strong></dt>
<dd>The 1-sigma error from the source fitting for ra [in arcsec], calculated by the
sourcefinder procedures. NOTE: the db unit is in arcsec, while the
sourcefinder produces degrees, so be careful with convertions.</dd>
<dt><strong>decl_fit_err</strong></dt>
<dd>The 1-sigma error from the source fitting for declination [in arcsec],
calculated by the sourcefinder procedures. NOTE: the db unit is in arcsec,
while the sourcefinder produces degrees, so be careful with convertions.</dd>
<dt><strong>ra_sys_err</strong></dt>
<dd>The systematic error on ra, as determined after source finder testing
by Dario Carbone and reported at 2012-12-04 <a class="reference external" href="https://speakerdeck.com/transientskp/source-finder-testing-overview-and-status">TKP Meeting</a>,
to be set at 20 arcsec.</dd>
<dt><strong>decl_sys_err</strong></dt>
<dd>The systematic error on decl, as determined after source finder testing
by Dario Carbone and reported at 2012-12-04 <a class="reference external" href="https://speakerdeck.com/transientskp/source-finder-testing-overview-and-status">TKP Meeting</a>,
to be set at 20 arcsec.</dd>
<dt><strong>x, y, z</strong></dt>
<dd>Cartesian coordinate representation of (ra,decl), calculated by the
database at insertion time.</dd>
<dt><strong>racosdecl</strong></dt>
<dd>The product of ra and cosine of the declination. Helpful in source look-up
association queries where we use the De Ruiter radius as an association
parameter.</dd>
<dt><strong>margin</strong></dt>
<dd>Used for association procedures to take into account sources that lie close
to ra=0 &amp; ra=360 meridian.
* True: source is close to ra=0 meridian
* False: source is far away enough from the ra=0 meridian
* NOTE &amp; TODO: This is not implemented yet.</dd>
<dt><strong>det_sigma</strong></dt>
<dd>The sigma level of the detection (Hanno&#8217;s thesis): 20*(f_peak/det_sigma)
gives the rms of the detection. Calculated by the sourcefinder procedures.</dd>
<dt><strong>semimajor</strong></dt>
<dd>Semi-major axis that was used for gauss fitting [in arcsec], calculated by
the sourcefinder procedures.</dd>
<dt><strong>semiminor</strong></dt>
<dd>Semi-minor axis that was used for gauss fitting [in arcsec], calculated by
the sourcefinder procedures.</dd>
<dt><strong>pa</strong></dt>
<dd>Position Angle that was used for gauss fitting [from north through local
east, in degrees], calculated by the sourcefinder procedures.</dd>
<dt><strong>f_peak</strong></dt>
<dd>peak flux [Jy], calculated by the sourcefinder procedures.</dd>
<dt><strong>f_peak_err</strong></dt>
<dd>1-sigma error (in Jy) of <tt class="docutils literal"><span class="pre">f_peak</span></tt>, calculated by the sourcefinder
procedures.</dd>
<dt><strong>f_int</strong></dt>
<dd>integrated flux [Jy], calculated by the sourcefinder procedures.</dd>
<dt><strong>f_int_err</strong></dt>
<dd>1-sigma error (in Jy) of <tt class="docutils literal"><span class="pre">f_int</span></tt>, calculated by the sourcefinder
procedures.</dd>
<dt><strong>extract_type</strong></dt>
<dd><p class="first">Reports how the source was extracted by sourcefinder (Hanno&#8217;s thesis),
generated by the sourcefinder procedures. Currently implemented values
are:</p>
<blockquote class="last">
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">NULL</span></tt>: gaussian fit</li>
<li><tt class="docutils literal"><span class="pre">NULL</span></tt>: moments fit</li>
<li><tt class="docutils literal"><span class="pre">1</span></tt>: forced fit to pixel</li>
</ul>
</div></blockquote>
</dd>
<dt><strong>node(s)</strong></dt>
<dd>Determine the current and number of nodes in case of a sharded database
set-up.</dd>
</dl>
</div>
<div class="section" id="frequencyband">
<h2>frequencyband<a class="headerlink" href="#frequencyband" title="Permalink to this headline">¶</a></h2>
<p>This table contains the frequency bands that are being used inside the
database.
Here we adopt the set of pre-defined Standard LOFAR Frequency Bands and their
bandwidths as defined for <a class="reference external" href="http://www.lofar.org/wiki/doku.php?id=msss:documentation#standard_msss-lba_frequency_bands">MSSS</a>.
Included are frequency bands outside the LOFAR bands, in order to match the
external catalogue frequency bands.
When an image is taken at an unknown band, it is added to this table by the SQL
function <tt class="docutils literal"><span class="pre">getBand()</span></tt>, using the image&#8217;s effective frequency as central
frequency and its bandwidth to determine the low and high end of the band.</p>
<dl class="docutils">
<dt><strong>id</strong></dt>
<dd>Every frequency band has its unique id, generated by the database.</dd>
<dt><strong>freq_central</strong></dt>
<dd>The central frequency of the defined frequency band. (Note that this is not
the effective frequency, which is stored as a property in the image table.)</dd>
<dt><strong>freq_low</strong></dt>
<dd>The low end of the frequency band.</dd>
<dt><strong>freq_high</strong></dt>
<dd>The high end of the frequency band.</dd>
</dl>
</div>
<div class="section" id="image">
<h2>image<a class="headerlink" href="#image" title="Permalink to this headline">¶</a></h2>
<p>This table contains the images that are being or were processed in the TraP.
Note that the format of the image is not stored as an image property.
An image might be a composite of multiple images, but it is not yet defined how
the
individual values for effective frequency, integration times, etc are
propagated to
the columns of the <tt class="docutils literal"><span class="pre">image</span></tt> table.
<a class="reference external" href="http://www.lofar.org/operations/lib/exe/fetch.php?media=public:documents:casa_image_for_lofar_0.03.00.pdf">The CASA Image description for LOFAR</a>
describes the structure of a LOFAR CASA Image,
from which most of the data of the <tt class="docutils literal"><span class="pre">image</span></tt> table originates from.</p>
<p>An image is characterised by</p>
<ul class="simple">
<li>observation timestamp (taustart_ts).</li>
<li>integration time (tau)</li>
<li>frequency band (band)</li>
<li>Stokes parameter (stokes)</li>
</ul>
<p>A group of images that belong together (defined by user, but not specified any
further) are in the same data set (i.e. they have the same reference to
dataset).</p>
<dl class="docutils">
<dt><strong>id</strong></dt>
<dd>Every image gets a unique id, generated by the database.</dd>
<dt><strong>dataset</strong></dt>
<dd>The dataset to which the image belongs to.</dd>
<dt><strong>tau</strong></dt>
<dd>The integration time of the image. This is a quick reference number related
to tau_time, similar as to which band is related to central frequency.
Currently this is not used.</dd>
<dt><strong>band</strong></dt>
<dd>The frequency band at which the observation was carried out. Its value
refers to the id in frequencyband, where the frequency bands are
predefined. The image&#8217;s effective frequency falls within this band. If an
image has observation frequency that is not in this table, a new entry will
be created based an the effective</dd>
<dt><strong>stokes</strong></dt>
<dd>The Stokes parameter of the observation. 1 = I, 2 = Q, 3 = U and 4 = V.
The Stokes parameter originates or is read from the CASA Main table in the
coords subsection from the <tt class="docutils literal"><span class="pre">stokesX</span></tt> record.
The char value is converted by the database to one of the four (tiny)
integers.</dd>
<dt><strong>tau_time</strong></dt>
<dd>The integration time (in seconds) of the image.
The value originates or is read from the CASA LOFAR_OBSERVATION table
by differencing the <tt class="docutils literal"><span class="pre">OBSERVATION_END</span></tt> and <tt class="docutils literal"><span class="pre">OBSERVATION_START</span></tt> data
fields.</dd>
<dt><strong>freq_eff</strong></dt>
<dd>The effective frequency (or synonymously rest frequency) (in Hz) at
which the observation was carried out.
The value originates or is read from the CASA Main table in the coords
subsection from the <tt class="docutils literal"><span class="pre">spectralX</span></tt> record and the <tt class="docutils literal"><span class="pre">crval</span></tt> field.
Note that in the case of FITS files the header keywords representing the
effective frequency are not uniquely defined and may differ per FITS file.</dd>
<dt><strong>freq_bw</strong></dt>
<dd>The frequency bandwidth (in Hz) of the observation.
Value originates or is read from the CASA Main table in the coords
subsection from the <tt class="docutils literal"><span class="pre">spectralX</span></tt> record and the <tt class="docutils literal"><span class="pre">cdelt</span></tt> field. N
This is a required value and when it is not available an error is thrown.</dd>
<dt><strong>taustart_ts</strong></dt>
<dd>The timestamp of the start of the observation, originating or read from
the CASA LOFAR_OBSERVATION table from the <tt class="docutils literal"><span class="pre">OBSERVATION_START</span></tt> data field.</dd>
<dt><strong>centre_ra</strong> and <strong>centre_decl</strong></dt>
<dd>The central coordinates (J2000) (or pointing centre) of the image in
degrees.
RA and dec values originate or are read from the CASA Main table in the
coords subsection from the <tt class="docutils literal"><span class="pre">pointingcenter</span></tt> record.
Note the conversion from radians to degrees.</dd>
<dt><strong>x</strong>, <strong>y</strong> and <strong>z</strong></dt>
<dd>The Cartesian coordinates of centre_ra and centre_decl.
Values are calculated by the database from centre_ra and centre_decl. Not
yet stored in table.</dd>
<dt><strong>rb_smaj</strong></dt>
<dd>The semi-major axis of the restoring beam, in degrees.
Full major axis value originates or is read from the CASA Main table in the imageinfor
subsection from the <tt class="docutils literal"><span class="pre">restoringbeam</span></tt> record and is converted at db insertion time.</dd>
<dt><strong>rb_smin</strong></dt>
<dd>The semi-minor axis of the restoring beam, in degrees.
Full minor axis value originates or is read from the CASA Main table in the imageinfor
subsection from the <tt class="docutils literal"><span class="pre">restoringbeam</span></tt> record and is converted at db insertion time.</dd>
<dt><strong>rb_pa</strong></dt>
<dd>The position angle of the restoring beam (from north to east to the major
axis), in degrees.
Value originates or is read from the CASA Main table in the imageinfor
subsection from the <tt class="docutils literal"><span class="pre">restoringbeam</span></tt> record.</dd>
<dt><strong>fwhm_arcsec</strong></dt>
<dd>The full width half maximum of the primary beam, in arcsec. Value not yet
stored in table.</dd>
<dt><strong>fov_degrees</strong></dt>
<dd>The field of view of the image, in square degrees. Not yet stored in table.</dd>
<dt><strong>url</strong></dt>
<dd>The url of the physical location of the image at the time of processing.
NOTE that this needs to be updated when the image is moved.</dd>
<dt><strong>node(s)</strong></dt>
<dd>Determine the current and number of nodes in case of a sharded database
set-up.</dd>
</dl>
</div>
<div class="section" id="monitoringlist">
<h2>monitoringlist<a class="headerlink" href="#monitoringlist" title="Permalink to this headline">¶</a></h2>
<p>This table contains the list of sources that are monitored. This implies that
the source finder software will measure the flux in an image at exactly the
given position.  These positions are 0 by default, since they can be retrieved
by joining with the runningcatalog.</p>
<p>For user defined sources, however, positions may be available that are more
precise than those in the runningcatalog.  Hence the ra and decl columns are
still necessary for these sources.  The runcat refers to the id in the
runningcatalog, when available.  Eg, manually inserted sources with positions
obtained differently will not have a runcat to start with (in which case
runcat will have the NULL value), until the first time the flux has been
measured; then these sources (even when actual upper limits) will be inserted
into extractedsources and runningcatalog, and have a runcat.  They will still
have userentry set to true, so that the position used is that in this table
(the more precise position), not that of the runningcatalog.</p>
<dl class="docutils">
<dt><strong>id</strong></dt>
<dd>Every source in the monitoringlist gets a unique id</dd>
<dt><strong>runcat</strong></dt>
<dd>Refers to the id in runningcatalog.</dd>
<dt><strong>ra</strong></dt>
<dd>The Right Ascension (J2000) of the source</dd>
<dt><strong>decl</strong></dt>
<dd>The Declination (J2000) of the source</dd>
<dt><strong>dataset</strong></dt>
<dd>Refers to the id in dataset, to which this monitoringlist belongs to.</dd>
<dt><strong>userentry</strong></dt>
<dd>Boolean to state whether it is an user inserted soure (true) or by the trap
(false)</dd>
</dl>
</div>
<div class="section" id="node">
<h2>node<a class="headerlink" href="#node" title="Permalink to this headline">¶</a></h2>
<p>This table keeps track of zones (declinations) of the stored sources on the
nodes in a sharded database configuration. Every node in such a set-up will
have this table, but with different content.</p>
<dl class="docutils">
<dt><strong>node</strong></dt>
<dd>The id of the node</dd>
<dt><strong>zone</strong></dt>
<dd>The zone that is available on the node</dd>
<dt><strong>zone_min</strong></dt>
<dd>The minimum zone of the zones</dd>
<dt><strong>zone_max</strong></dt>
<dd>The maximum zone of the zones</dd>
<dt><strong>zone_min_incl</strong></dt>
<dd>Boolean determining whether the minimum zone is included.</dd>
<dt><strong>zone_max_incl</strong></dt>
<dd>Boolean determining whether the maximum zone is included.</dd>
<dt><strong>zoneheight</strong></dt>
<dd>The zone height of a zone, in degrees</dd>
<dt><strong>nodes</strong></dt>
<dd>The total number of nodes in the sharded database configuration.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The following sections on the <tt class="docutils literal"><span class="pre">runningcatalog</span></tt>, <tt class="docutils literal"><span class="pre">runningcatalog_flux</span></tt> and
<tt class="docutils literal"><span class="pre">temprunningcatalog_flux</span></tt> are annotated using the style of mathematical
notations developed in the <a class="reference internal" href="#mathematical-diversion"><em>Appendix</em></a>.</p>
</div>
</div>
<div class="section" id="runningcatalog">
<span id="schema-runningcatalog"></span><h2>runningcatalog<a class="headerlink" href="#runningcatalog" title="Permalink to this headline">¶</a></h2>
<p>(See <a class="reference internal" href="#mathematical-diversion"><em>Mathematical diversion</em></a> for explanation of mathematical notation.)</p>
<p>While a single entry in <tt class="docutils literal"><span class="pre">extractedsource</span></tt> corresponds to an individual
source measurement, a single entry in <tt class="docutils literal"><span class="pre">runningcatalog</span></tt> corresponds to a
unique astronomical source detected in a specific dataset (series of images).
The position of this unique source is a weighted mean of all its individual
source measurements.  The relation between a <tt class="docutils literal"><span class="pre">runningcatalog</span></tt> source and all
its measurements in <tt class="docutils literal"><span class="pre">extractedsource</span></tt> is maintained in <tt class="docutils literal"><span class="pre">assocxtrsource</span></tt>.</p>
<p>The association procedure matches extracted sources with counterpart
candidates in the runningcatalog table.  Depending on their association
parameters (distance and De Ruiter radius) of the <tt class="docutils literal"><span class="pre">runningcatalog</span></tt> source
and <tt class="docutils literal"><span class="pre">extractedsource</span></tt> source, the source pair ids are added to
<tt class="docutils literal"><span class="pre">assocxtrsource</span></tt>.  The source properties, position, fluxes and their errors
in the <tt class="docutils literal"><span class="pre">runningcatalog</span></tt> and <tt class="docutils literal"><span class="pre">runningcatalog_flux</span></tt> tables are then updated
to include the counterpart values from the extracted source as a new
datapoint.</p>
<p>If no counterpart could be found for an extracted sources, it is appended to
<tt class="docutils literal"><span class="pre">runningcatalog</span></tt> as a &#8220;new&#8221; source (datapoint=1).</p>
<dl class="docutils">
<dt><strong>id</strong></dt>
<dd>Every source in the running catalog gets a unique id.</dd>
<dt><strong>xtrsrc</strong></dt>
<dd>The id of the extractedsource for which this runningcatalog source was
detected for the first time.</dd>
<dt><strong>dataset</strong></dt>
<dd>The dataset to which the runningcatalog source belongs to.</dd>
<dt><strong>datapoints</strong> <span class="math">\(= N_\alpha\)</span> or equivalently <span class="math">\(N_\delta\)</span></dt>
<dd>The number of datapoints (or number of times this source was detected)
that is included in the calculation of the <em>position</em> averages.  It is
assumed that a source&#8217;s position stays relatively constant across bands
and therefore all bands are included in averaging the position.</dd>
<dt><strong>zone</strong></dt>
<dd>The zone id in which the source declination resides.  The sphere is divided
into zones of equal width: here fixed to 1 degree, and the zone is
effectively the truncated declination. (decl=31.3 =&gt; zone=31, decl=31.9 =&gt;
zone=31)</dd>
<dt><strong>wm_ra</strong> <span class="math">\(= \xi_{\alpha}\)</span></dt>
<dd>The weighted mean of RA of the source [in J2000 degrees].</dd>
<dt><strong>wm_decl</strong> <span class="math">\(=\xi_{\delta}\)</span></dt>
<dd>The weighted mean of Declination of the source [in J2000 degrees].</dd>
<dt><strong>wm_ra_err</strong></dt>
<dd>The weighted mean of the ra_err of the source [in arcsec]</dd>
<dt><strong>wm_decl_err</strong></dt>
<dd>The weighted mean of the decl_err of the source [in arcsec]</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">I am not sure that the weighted mean of the errors is useful, since the
weighting is dependent upon the errors themselves.  A simple mean error
might be more sensible.  -TS 30/01/13</p>
</div>
<dl class="docutils">
<dt><strong>avg_wra</strong> <span class="math">\(=\overline{w_{\alpha}\alpha}\)</span></dt>
<dd>The average of ra/ra_err^2, used for calculating the average weight of ra.
(This alleviates the computations, when we have lots of datapoints.)</dd>
<dt><strong>avg_wdecl</strong> <span class="math">\(=\overline{w_{\delta}\delta}\)</span></dt>
<dd>Analogous to avg_wra.</dd>
<dt><strong>avg_weight_ra</strong> <span class="math">\(=\overline{w_{\alpha}}\)</span></dt>
<dd>The average of 1/ra_err^2, used for calculating the weighted mean of ra.
(This alleviates the computations, when we have lots of datapoints.)</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Is it really more efficient this way? It would be good to get a more detailed
explanation. -TS 30/01/13</p>
</div>
<dl class="docutils">
<dt><strong>avg_weight_decl</strong>   <span class="math">\(=\overline{w_{\delta}}\)</span></dt>
<dd>Analogous to avg_weight_ra</dd>
<dt><strong>x, y, z</strong></dt>
<dd>The Cartesian coordinate representation of wm_ra and wm_decl</dd>
<dt><strong>margin</strong></dt>
<dd>Boolean to define that a source is near the 360-0 meridian. Not being used.</dd>
<dt><strong>inactive</strong></dt>
<dd>Boolean to set an entry to inactive.  This is done during the <a class="reference internal" href="assoc.html#database-assoc"><em>source
association</em></a> procedure, where e.g. the many-to-many cases
are handled and an existing entry is replaced by two or more entries.</dd>
</dl>
</div>
<div class="section" id="runningcatalog-flux">
<span id="schema-runningcatalog-flux"></span><h2>runningcatalog_flux<a class="headerlink" href="#runningcatalog-flux" title="Permalink to this headline">¶</a></h2>
<p>The runningcatalog_flux table contains the averaged flux measurements of a
runningcatalog source, per band and stokes parameter. The combination runcat,
band and stokes is the primary key.</p>
<p>The flux squared and weights are used for calculations of the variability
indices, V and eta.</p>
<dl class="docutils">
<dt><strong>runcat</strong></dt>
<dd>Reference to the runningcatalog id to which this band/stokes/flux belongs
to</dd>
<dt><strong>band</strong></dt>
<dd>Reference to the frequency band of this flux</dd>
<dt><strong>stokes</strong></dt>
<dd>Stokes parameter: 1 = I, 2 = Q, 3 = U, 4 = V</dd>
<dt><strong>f_datapoints</strong>   <span class="math">\(=N_I\)</span></dt>
<dd>the number of <em>flux</em> datapoints for which the flux averages were calculated.</dd>
<dt><strong>resolution</strong></dt>
<dd>Not used.</dd>
<dt><strong>avg_f_peak</strong>  <span class="math">\(=\overline{I}\)</span></dt>
<dd>Average of peak flux</dd>
<dt><strong>avg_f_peak_sq</strong> <span class="math">\(=\overline{{I}^2}\)</span></dt>
<dd>Average of (peak flux)^2</dd>
<dt><strong>avg_f_peak_weight</strong>    <span class="math">\(=\overline{w_{I}}\)</span></dt>
<dd>Average of one over peak flux errors squared</dd>
<dt><strong>avg_weighted_f_peak</strong> <span class="math">\(=\overline{w_{I} I}\)</span></dt>
<dd>Average of ratio of (peak flux) and (peak flux errors squared)</dd>
<dt><strong>avg_weighted_f_peak_sq</strong> <span class="math">\(=\overline{w_{I} I^2}\)</span></dt>
<dd>Average of (weighted peak flux squared)</dd>
<dt><strong>avg_f_int, avg_f_int_sq, avg_f_int_weight, avg_weighted_f_int, avg_weighted_f_int_sq</strong></dt>
<dd>Analogous to those above, except for the <em>integrated</em> flux.</dd>
</dl>
</div>
<div class="section" id="temprunningcatalog">
<span id="database-temprunningcatalog"></span><h2>temprunningcatalog<a class="headerlink" href="#temprunningcatalog" title="Permalink to this headline">¶</a></h2>
<p>(See also <a class="reference internal" href="assoc.html#database-assoc-details"><em>source association detailed logic</em></a>.)</p>
<p>Most of the entries in the <tt class="docutils literal"><span class="pre">temprunningcatalog</span></tt> are identical to those of the
same name in <a class="reference internal" href="#schema-runningcatalog"><em>runningcatalog</em></a> and <a class="reference internal" href="#schema-runningcatalog-flux"><em>runningcatalog_flux</em></a>,
except updated to include the information from a new <tt class="docutils literal"><span class="pre">extractedsource</span></tt>.
Those without direct counterparts in those tables are listed below.</p>
<dl class="docutils">
<dt><strong>runcat</strong></dt>
<dd>Reference to the <tt class="docutils literal"><span class="pre">runningcatalog</span></tt> id. runcat and xtrsrc together form a
unique combination.</dd>
<dt><strong>xtrsrc</strong></dt>
<dd>Reference to the <tt class="docutils literal"><span class="pre">extractedsource</span></tt> id. runcat and xtrsrc together form a
unique combination.</dd>
<dt><strong>distance_arcsec</strong></dt>
<dd>The distance in arcsec on the sky of the runcat-xtrsrc association,
calculated by the database.</dd>
<dt><strong>r</strong></dt>
<dd>The De Ruiter radius of the runcat-xtrsrc association, calculated by the
database.</dd>
<dt><strong>inactive</strong></dt>
<dd>During evaluation of the association pairs, some pairs might be set to
inactive (TRUE), defaults to FALSE.</dd>
<dt><strong>beam_semimaj, beam_semimin, beam_pa</strong></dt>
<dd>Not used (yet)</dd>
</dl>
</div>
<div class="section" id="transient">
<h2>transient<a class="headerlink" href="#transient" title="Permalink to this headline">¶</a></h2>
<p>This table contains the detected transients and their characteristics. Based on
the values of the variability indices a source is considered a transient and
appended to the transient table.</p>
<p>We choose to test the null hypothesis, <span class="math">\(H_0\)</span>, that the source under
consideration is not variable. Contributing terms to <span class="math">\(\eta_{\nu}\)</span> in the
sum will be of the order of unity, giving a value of roughly one after
<span class="math">\(N\)</span> measurements.  With the integral probability, we can quantify the
probability of having a value equal to or larger than the <span class="math">\(\eta_{\nu}\)</span>
obtained from the measurements.</p>
<dl class="docutils">
<dt><strong>id</strong></dt>
<dd>Every source in the transient table gets a unique id, set by the database</dd>
<dt><strong>runcat</strong></dt>
<dd>Reference to the runningcatalog source to which this transient belongs to.
Since every trasient has an entry in th erunningcatalog this cannot be
NULL.</dd>
<dt><strong>band</strong></dt>
<dd>The frequency band in which the transient was found, and for which th
evariability are calculated</dd>
<dt><strong>siglevel</strong></dt>
<dd>The significance level of the 2nd variability index value. Calculated by
the scipy module chisqprob(), where we use <span class="math">\(N-1\)</span> as the degree of
freedom</dd>
<dt><strong>v_int</strong></dt>
<dd>The first variability index, <span class="math">\(V_{\nu}\)</span>, based on the integrated flux
values.</dd>
<dt><strong>eta_int</strong></dt>
<dd>The second variability index, <span class="math">\(\eta_{\nu}\)</span>, based on the integrated
flux values.</dd>
<dt><strong>detection_level</strong></dt>
<dd>Currently not set</dd>
<dt><strong>trigger_xtrsrc</strong></dt>
<dd>Reference to the extracted source id that caused this transient to be added</dd>
<dt><strong>status</strong></dt>
<dd>Currently not set</dd>
<dt><strong>t_start</strong></dt>
<dd>Currently not set</dd>
</dl>
</div>
<div class="section" id="version">
<h2>version<a class="headerlink" href="#version" title="Permalink to this headline">¶</a></h2>
<p>This table contains the current schema version of the database. Every schema
upgrade will increment the value by 1.</p>
<dl class="docutils">
<dt><strong>name</strong></dt>
<dd>The name of the version</dd>
<dt><strong>value</strong></dt>
<dd>The version number, which increments after every database change</dd>
</dl>
</div>
</div>
<div class="section" id="appendices">
<h1>Appendices<a class="headerlink" href="#appendices" title="Permalink to this headline">¶</a></h1>
<div class="section" id="mathematical-diversion">
<span id="id2"></span><h2>Mathematical diversion<a class="headerlink" href="#mathematical-diversion" title="Permalink to this headline">¶</a></h2>
<div class="section" id="on-iteratively-updated-weighted-means">
<h3>On iteratively updated weighted means<a class="headerlink" href="#on-iteratively-updated-weighted-means" title="Permalink to this headline">¶</a></h3>
<p>We now take a diversion to note the mechanics of storing and updating weighted
means - this happens a lot in the database.</p>
<p>We define the average (specifically, the <em>arithmetic mean</em>) of <span class="math">\(x\)</span> as</p>
<div class="math">
\[\overline{x}_N = \frac{1}{N} \sum_{i=1}^{N} x_i\]</div>
<p>where <span class="math">\(x_i\)</span> is the <span class="math">\(i\)</span> th measurement of <span class="math">\(x\)</span>.</p>
<p>We may update this in an iterative fashion.
If we add the next datapoint, <span class="math">\(x_{N+1}\)</span>, to it, we can build the
new average as:</p>
<div class="math" id="equation-simple_mean_update">
<span class="eqno">(1)</span>\[\overline{x}_{N+1} = \frac{N \overline{x}_N + x_{N+1}}{N+1} .\]</div>
<p>We now treat weighted means.</p>
<p>We first define the weight of the <span class="math">\(i\)</span> th measurement of x,</p>
<div class="math">
\[w_{x_i} = 1/{e_{x_i}}^2\]</div>
<p>where <span class="math">\(e_{x_i}\)</span> is the one-sigma error in the <span class="math">\(i\)</span> th measurement
of x.</p>
<p>We can now define a weighted mean of N measurements of <span class="math">\(x\)</span>;
<span class="math">\(\xi_{x_N}\)</span> as:</p>
<div class="math">
\[\xi_{x_N} = \frac{\sum_{i=1}^{N} w_{x_i} x_i}{\sum_{i=1}^{N} w_{x_i}}.\]</div>
<p>To update this weighted average,
we first define the sum of the weights as</p>
<div class="math">
\[W_{x_N} = \sum_{i=1}^{N} w_{x_i}\]</div>
<p>we may then calculate the  weighted average after N+1 measurements as:</p>
<div class="math" id="equation-wt_mean_update_1">
<span class="eqno">(2)</span>\[\xi_{x_{N+1}} =   \frac{ W_{x_N} \xi_{{x_N}} + w_{{x_{N+1}}}x_{N+1}}
                              { W_{x_N} + w_{x_{N+1}} }\]</div>
<p>Note, if we define the mean or &#8216;bar&#8217; operator such that:</p>
<div class="math">
\[\overline{y}_{N} = \frac{\sum_{i=1}^{N} y_i}{N}\]</div>
<p>for any variable <span class="math">\(y\)</span>, then</p>
<div class="math">
\[\overline{w}_{x_N} = \frac{\sum_{i=1}^{N} w_{x_i}}{N} = \frac{W_{x_N}}{N}\]</div>
<p>and we may use the formula:</p>
<div class="math" id="equation-wt_mean_update_2">
<span class="eqno">(3)</span>\[\xi_{x_{N+1}} =
 \frac{ N \overline{w}_{x_N} \xi_{x_N} + w_{x_{N+1}}x_{N+1}}
      { N \overline{w}_{x_N} + w_{x_{N+1}} }\]</div>
<p>(Note how this simplifies if <span class="math">\(w_i = 1 \quad \forall i\)</span>)</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>For tracking Ra and Dec  (<span class="math">\(\alpha\)</span> and <span class="math">\(\delta\)</span>) weighted
means, we substitute</p>
<div class="math">
\[N \overline{ w_{\alpha_N} } \xi_{\alpha_N} =
N \overline{ (w_{\alpha} \alpha )_N}\]</div>
<p>to yield another manipulation of the update formula:</p>
<div class="math" id="equation-wt_mean_update_3">
<span class="eqno">(4)</span>\[\xi_{\alpha_{N+1}} =
 \frac{ N \overline{ (w_{\alpha} \alpha )_N} + w_{\alpha_{N+1}}\alpha_{N+1}}
      { N \overline{w}_{\alpha_N} + w_{\alpha_{N+1}} }\]</div>
<p class="last"><strong>Note that this requires that we also keep track of the extra aggregate
value:</strong> <span class="math">\(\overline{ (w_{\alpha} \alpha )_N}\)</span>, which is probably
unnecessary given that we are not performing reduced-<span class="math">\(\chi^2\)</span> stats
on the position.</p>
</div>
<p>In general, we perform similar tricks with aggregate values (i.e. storing the
&#8216;barred&#8217; values of variables) throughout the database code. This has pros and
cons - it makes the equations below a little prettier (and possibly simpler to
compute), but requires many multiplications and divisions by the factor
<span class="math">\(N\)</span> (hence, also possibly harder to compute - this may be worth careful
consideration during the next big code review).</p>
</div>
<div class="section" id="on-aggregated-variability-indexes">
<h3>On &#8216;aggregated&#8217; variability indexes<a class="headerlink" href="#on-aggregated-variability-indexes" title="Permalink to this headline">¶</a></h3>
<p>We now explain how running averages are used to compute the &#8216;variability indices&#8217;
we use in identifying sources which may be intrinsically transient or variable.
(Adopted from Bart Scheers&#8217; PhD thesis.)</p>
<p>The first variability indicator, the proportional flux variability of a
source, is expressed as the ratio of the sample standard deviation, and mean,
of the flux <span class="math">\(I\)</span>; that is to say:</p>
<div class="math">
\[V = \frac{ s}{ \overline{I} }\]</div>
<p>where <span class="math">\(s\)</span> is the unbiased sample standard deviation:</p>
<div class="math">
\[s = \sqrt{ \frac{1}{N-1} \sum_{i=1}^N \left( I_i - \overline{I}  \right)^2 }\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In general, we may consider calculating all these values per frequency-band
and subscript them by band central frequency <span class="math">\(\nu\)</span>, but we neglect such
details here for simplicity.</p>
</div>
<p>Written in its well known &#8216;aggregate&#8217; form, it is now easy to handle bulk
data, and is defined as</p>
<div class="math">
\[V = \frac{1}{\overline{I}}
          \sqrt{ \frac{N}{N-1}
                    \left( \overline{{I}^2} - \overline{I}^2  \right)
               }\]</div>
<p>The second indicator, the significance of the flux variability, is based on
reduced <span class="math">\(\chi^2\)</span> statistics. We derive the aggregate form here.</p>
<p>We begin with the familiar reduced-<span class="math">\(\chi^2\)</span> formula, except with the
regular arithmetic mean <span class="math">\(\overline{I}\)</span> replaced by the
weighted mean <span class="math">\(\xi_{I_N}\)</span>,</p>
<div class="math">
\[\xi_{I_N} = \frac{\sum_{i=1}^{N} w_i I_i}{\sum_{i=1}^{N} w_i}
      = \frac{\overline{w_i I_i} }{ \overline{w_i}},\]</div>
<p>resulting in:</p>
<div class="math">
\[\eta = \frac{1}{N-1}
              \sum_{i=1}^N
                 \frac{\left(I_i - \xi_{I_N} \right)^2}
                     {e_i^2}\]</div>
<p>where <span class="math">\(e_i\)</span> is the estimated uncertainty, or standard deviation,
in <span class="math">\(I_i\)</span>.  We may rewrite this using <span class="math">\(\frac{1}{e_i^2} = w_i\)</span>:</p>
<div class="math">
\[\eta = \frac{N}{N-1}\lgroup \frac{1}{N}
              \sum_{i=1}^N w_i \left(I_i - \xi_{I_N} \right)^2 \rgroup\]</div>
<p>Expanding inside the brackets gives:</p>
<div class="math">
\[\frac{1}{N}\sum_{i=1}^N
   w_i \left( I_i^2 - 2\xi_{I_N} I_i + \xi_{I_N}^2 \right)\]\[ = \frac{1}{N} \sum_{i=1}^N w_i I_i^2
   - 2\xi_{I_N} \frac{1}{N}\sum_{i=1}^N w_i I_i
   + \xi_{I_N}^2 \frac{1}{N}\sum_{i=1}^N w_i\]\[= \overline{w_i I_i^2} - 2\xi_{I_N} \overline{w_i I_i} +\xi_{I_N}^2 \overline{w_i}
   \qquad .\]</div>
<p>Expanding for <span class="math">\(\xi_{I_N}\)</span> results in the final aggregate form of
the reduced-<span class="math">\(\chi^2\)</span>:</p>
<div class="math">
\[\eta = \frac{N}{N-1}
             \left(
                \overline{w {I}^2}
                -
                \frac{\overline{w I}^2}{\overline{w}}
             \right)\]</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Schema</a><ul>
<li><a class="reference internal" href="#assoccatsource">assoccatsource</a></li>
<li><a class="reference internal" href="#assocxtrsource">assocxtrsource</a></li>
<li><a class="reference internal" href="#catalogedsource">catalogedsource</a></li>
<li><a class="reference internal" href="#catalog">catalog</a></li>
<li><a class="reference internal" href="#classification">classification</a></li>
<li><a class="reference internal" href="#dataset">dataset</a></li>
<li><a class="reference internal" href="#extractedsource">extractedsource</a></li>
<li><a class="reference internal" href="#frequencyband">frequencyband</a></li>
<li><a class="reference internal" href="#image">image</a></li>
<li><a class="reference internal" href="#monitoringlist">monitoringlist</a></li>
<li><a class="reference internal" href="#node">node</a></li>
<li><a class="reference internal" href="#runningcatalog">runningcatalog</a></li>
<li><a class="reference internal" href="#runningcatalog-flux">runningcatalog_flux</a></li>
<li><a class="reference internal" href="#temprunningcatalog">temprunningcatalog</a></li>
<li><a class="reference internal" href="#transient">transient</a></li>
<li><a class="reference internal" href="#version">version</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendices">Appendices</a><ul>
<li><a class="reference internal" href="#mathematical-diversion">Mathematical diversion</a><ul>
<li><a class="reference internal" href="#on-iteratively-updated-weighted-means">On iteratively updated weighted means</a></li>
<li><a class="reference internal" href="#on-aggregated-variability-indexes">On &#8216;aggregated&#8217; variability indexes</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="intro.html"
                        title="previous chapter">Database</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="assoc.html"
                        title="next chapter">Source Association</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/database/schema.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="assoc.html" title="Source Association"
             >next</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Database"
             >previous</a> |</li>
        <li><a href="../index.html">LOFAR Transients Tools Release 0 documentation</a> &raquo;</li>
          <li><a href="index.html" >The TKP Database</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, LOFAR Transients Key Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>