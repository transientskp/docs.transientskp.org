<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>tkp.classification.features.lightcurve – Lightcurve feature extraction utilities &mdash; LOFAR Transients Pipeline 1.0 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../../_static/lofar.ico"/>
    <link rel="top" title="LOFAR Transients Pipeline 1.0 documentation" href="../../../../index.html" />
    <link rel="up" title="Feature extraction package" href="index.html" />
    <link rel="next" title="tkp.classification.features.catalogs – Catalog source matching" href="catalogs.html" />
    <link rel="prev" title="Feature extraction package" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="catalogs.html" title="tkp.classification.features.catalogs – Catalog source matching"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Feature extraction package"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../../index.html">LOFAR Transients Pipeline 1.0 documentation</a> &raquo;</li>
          <li><a href="../../../index.html" >Developer&#8217;s Reference Guide</a> &raquo;</li>
          <li><a href="../../index.html" >Library &amp; API</a> &raquo;</li>
          <li><a href="../index.html" >Classification package</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Feature extraction package</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-tkp.classification.features.lightcurve">
<span id="tkp-classification-features-lightcurve-lightcurve-feature-extraction-utilities"></span><span id="classification-features-lightcurve"></span><h1><a class="reference internal" href="#module-tkp.classification.features.lightcurve" title="tkp.classification.features.lightcurve: Lightcurve feature extraction utilities."><tt class="xref py py-mod docutils literal"><span class="pre">tkp.classification.features.lightcurve</span></tt></a> &#8211; Lightcurve feature extraction utilities<a class="headerlink" href="#module-tkp.classification.features.lightcurve" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-lightcurve"></span><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">synopsis:</th><td class="field-body">Obtain light curve characteristics of a transient source</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="tkp.classification.features.lightcurve.LightCurve">
<em class="property">class </em><tt class="descclassname">tkp.classification.features.lightcurve.</tt><tt class="descname">LightCurve</tt><big>(</big><em>taustart_tss</em>, <em>tau_times</em>, <em>fluxes</em>, <em>errors</em>, <em>srcids=None</em>, <em>bands=None</em>, <em>stokes=None</em>, <em>freq_central=None</em><big>)</big><a class="reference internal" href="../../../../_modules/tkp/classification/features/lightcurve.html#LightCurve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.classification.features.lightcurve.LightCurve" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple class that holds a light curve by means of several numpy
arrays.</p>
<p>Args:</p>
<blockquote>
<div><p>taustart_tss (list or array of datetime.datetime() instances):
(mid) observing times</p>
<p>tau_times (list or array of floats): integration times in seconds</p>
<p>fluxes (list or array of floats): flux levels in Janskys</p>
<p>errors (list or array of floats): flux errors in Janskys</p>
<p>srcids (list or array of ints, None): database id of &#8216;extracted
source&#8217; for each data point. If left to the default of None, this
is ignored.</p>
<p>bands (list or array of ints, None): frequency band ID&#8217;s</p>
<p>stokes (list or array of ints, None): stokes</p>
</div></blockquote>
<p>Raises:</p>
<blockquote>
<div><ul class="simple">
<li>ValueError: when input arguments are not equal length.</li>
</ul>
</div></blockquote>
<dl class="classmethod">
<dt id="tkp.classification.features.lightcurve.LightCurve.from_database">
<em class="property">classmethod </em><tt class="descname">from_database</tt><big>(</big><em>cursor</em>, <em>srcid</em><big>)</big><a class="reference internal" href="../../../../_modules/tkp/classification/features/lightcurve.html#LightCurve.from_database"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.classification.features.lightcurve.LightCurve.from_database" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the complete light curve from the database</p>
<p>Args:</p>
<blockquote>
<div><p>cursor: database cursor</p>
<p>srcid (int): id of the source in the database</p>
</div></blockquote>
<p>Fills the attributes with data obtained from the
database. Attributes of the class are the same as those for
the constructor. In this case, the srcids attribute is always
filled, and reflects the individual extracted sources.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">closing</span><span class="p">(</span><span class="n">Database</span><span class="p">())</span> <span class="k">as</span> <span class="n">database</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">lightcurve</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="o">.</span><span class="n">from_database</span><span class="p">(</span><span class="n">database</span><span class="o">.</span><span class="n">cursor</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tkp.classification.features.lightcurve.LightCurve.reset">
<tt class="descname">reset</tt><big>(</big><big>)</big><a class="reference internal" href="../../../../_modules/tkp/classification/features/lightcurve.html#LightCurve.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.classification.features.lightcurve.LightCurve.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset all the extracted features to their default values</p>
<p>The default values are generally numpy.nan or 0; using NaN
often provides a better indication for other function or
methods that the data does not exist.</p>
</dd></dl>

<dl class="method">
<dt id="tkp.classification.features.lightcurve.LightCurve.calc_background">
<tt class="descname">calc_background</tt><big>(</big><em>niter=-50</em>, <em>kappa=(5</em>, <em>5)</em><big>)</big><a class="reference internal" href="../../../../_modules/tkp/classification/features/lightcurve.html#LightCurve.calc_background"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.classification.features.lightcurve.LightCurve.calc_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate background flux</p>
<p>Kwargs:</p>
<blockquote>
<div><p>niter (int): number of iterations. Passed on to sigmaclip()</p>
<dl class="docutils">
<dt>kappa (2-tuple of floats): lower and upper kappa</dt>
<dd>values. Passed on to sigmaclip()</dd>
</dl>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><dl class="docutils">
<dt>(dict): mean, sigma, indices</dt>
<dd>where light curve is at background level (True) and where
not (False).</dd>
</dl>
</div></blockquote>
<p>Uses sigmaclipping to estimate a background. This only works
well when there are enough background points.</p>
<p>Also estimates the first point in time where the light curve
deviates from the background (T_zero), and the current duration
where the light curve is above the background.</p>
</dd></dl>

<dl class="method">
<dt id="tkp.classification.features.lightcurve.LightCurve.calc_duration">
<tt class="descname">calc_duration</tt><big>(</big><em>indices=None</em><big>)</big><a class="reference internal" href="../../../../_modules/tkp/classification/features/lightcurve.html#LightCurve.calc_duration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.classification.features.lightcurve.LightCurve.calc_duration" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate duration and estimate start of the transient event</p>
<p>Kwargs:</p>
<blockquote>
<div><dl class="docutils">
<dt>indices (numpy.ndarray): None or a numpy.ndarray of</dt>
<dd>relevant indices; that is, the indices for points
where the light curve duration should be calculated.</dd>
</dl>
</div></blockquote>
<p>It calculates two durations:</p>
<ul class="simple">
<li>full duration, from first rise above background until last bit
above background. This is simply the end time - start time.</li>
<li>active duration, where any intermediate returns to the
background level are ignored. This takes only the observed bins
and multiplies those with their respective integration
times. Any observations outside of any transient activity do not
contribute to this value.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="tkp.classification.features.lightcurve.LightCurve.calc_fluxincrease">
<tt class="descname">calc_fluxincrease</tt><big>(</big><em>background=None</em>, <em>indices=None</em><big>)</big><a class="reference internal" href="../../../../_modules/tkp/classification/features/lightcurve.html#LightCurve.calc_fluxincrease"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.classification.features.lightcurve.LightCurve.calc_fluxincrease" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the peak flux, its increase (absolute &amp; relative) and
the peak index</p>
<p>Kwargs:</p>
<blockquote>
<div><dl class="docutils">
<dt>background (float): previously calculated background (or</dt>
<dd>given by the user). If not given, the background is
calculated first.</dd>
<dt>indices (numpy.ndarray): None or a numpy.ndarray of</dt>
<dd>relevant indices; that is, the indices for points
where the light curve duration should be calculated.</dd>
</dl>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><dl class="docutils">
<dt>(dict): a dictionary with keys <cite>peak</cite> (the peak flux),</dt>
<dd><cite>ipeak</cite> (the index of the light curve for the peak
flux), <cite>increase</cite> (a dictionary of flux increase
values, the two keys indicated the <cite>absolute</cite> and
<cite>relative</cite> flux increase).</dd>
</dl>
</div></blockquote>
<p>In case of several local maxima (multiple outbursts), only the
peak flux and increase/decrease for the outburst in which the
peak flux falls is calculated.</p>
<p>The peak flux can be <em>negative</em> (eg, occultation transient), in
which case increase becomes negative.</p>
<p>If all indices are True, then the source is still at its
background level, and no clear transient exists: ipeak will
be None, increase is an empty dict and peakflux is 0.0.</p>
</dd></dl>

<dl class="method">
<dt id="tkp.classification.features.lightcurve.LightCurve.calc_risefall">
<tt class="descname">calc_risefall</tt><big>(</big><em>background=None</em>, <em>indices=None</em>, <em>ipeak=None</em><big>)</big><a class="reference internal" href="../../../../_modules/tkp/classification/features/lightcurve.html#LightCurve.calc_risefall"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.classification.features.lightcurve.LightCurve.calc_risefall" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the (total) flux increase &amp; decrease</p>
<p>Kwargs:</p>
<blockquote>
<div><dl class="docutils">
<dt>background (float): previously calculated background (or</dt>
<dd>given by the user). If not given, the background is
calculated first.</dd>
<dt>indices (numpy.ndarray): None or a numpy.ndarray of</dt>
<dd>relevant indices; that is, the indices for points
where the light curve duration should be calculated.</dd>
</dl>
<p>ipeak: the index of the light curve maximum. If not set,
calculated by <cite>calc_fluxincrease</cite>.</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>(3-tuple):</p>
<blockquote>
<div><ul class="simple">
<li>the first two elements are themselves two-tuples
that contain the flux increase or decrease (first element)
and the time interval (second element).</li>
<li>the third element is a number that indicates
the ratio between the increase and decrease.
The number is zero if the increase or decrease
could not be calculated.</li>
</ul>
</div></blockquote>
</div></blockquote>
<p>This method calculated the flux increase and decrease, as well
as the time interval over which the flux increases or
decreases.</p>
<p>Note: when values are not available (mostly when the light
curve hasn&#8217;t yet returned to background), they will be set to
0. This is an integer, and one could use this to see if this is
a calculated value or a indication of a non-available value, while
it is still compatible with (calculated) float values, in contrast
to eg None.</p>
</dd></dl>

<dl class="method">
<dt id="tkp.classification.features.lightcurve.LightCurve.calc_stats">
<tt class="descname">calc_stats</tt><big>(</big><em>indices=None</em><big>)</big><a class="reference internal" href="../../../../_modules/tkp/classification/features/lightcurve.html#LightCurve.calc_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tkp.classification.features.lightcurve.LightCurve.calc_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate some standard statistics.</p>
<p>Kwargs:</p>
<blockquote>
<div><dl class="docutils">
<dt>indices (numpy.ndarray of bool): specific selection of data to</dt>
<dd>use for calculations</dd>
</dl>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><dl class="docutils">
<dt>(dict): statistics of the <em>full</em> light curve (ie, including</dt>
<dd>background parts): mean, standard deviation, skew,
kurtosis. All calculated values are weighted by the flux
errors.</dd>
</dl>
</div></blockquote>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../../index.html">
              <img class="logo" src="../../../../_static/lofar.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Feature extraction package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="catalogs.html"
                        title="next chapter"><tt class="docutils literal"><span class="pre">tkp.classification.features.catalogs</span></tt> &#8211; Catalog source matching</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../../../_sources/devref/tkp/classification/features/lightcurve.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="catalogs.html" title="tkp.classification.features.catalogs – Catalog source matching"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Feature extraction package"
             >previous</a> |</li>
        <li><a href="../../../../index.html">LOFAR Transients Pipeline 1.0 documentation</a> &raquo;</li>
          <li><a href="../../../index.html" >Developer&#8217;s Reference Guide</a> &raquo;</li>
          <li><a href="../../index.html" >Library &amp; API</a> &raquo;</li>
          <li><a href="../index.html" >Classification package</a> &raquo;</li>
          <li><a href="index.html" >Feature extraction package</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, LOFAR Transients Key Project.
    </div>
  </body>
</html>