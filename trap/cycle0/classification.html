

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Classification &mdash; TRAP 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="TRAP 1.0 documentation" href="index.html" />
    <link rel="next" title="Monitoring list" href="monitoringlist.html" />
    <link rel="prev" title="Alerts recipe" href="alerts.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="monitoringlist.html" title="Monitoring list"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="alerts.html" title="Alerts recipe"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">TRAP 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="classification">
<span id="id1"></span><h1>Classification<a class="headerlink" href="#classification" title="Permalink to this headline">¶</a></h1>
<p>Attempt to classify the detected transients into one or more groups.</p>
<ul class="simple">
<li>inputs:</li>
</ul>
<dl class="docutils">
<dt>parset = %(runtime_directory)s/jobs/%(job_name)s/parsets/classification.parset</dt>
<dd><ul class="first last simple">
<li>parset: parameter set, currently containing only one parameter:<ul>
<li>weighting.cutoff: Any classified transient with a total
classification weight below this value will not be output.</li>
</ul>
</li>
<li>nproc: number of maximum simultaneous processors per node.</li>
</ul>
</dd>
</dl>
<ul class="simple">
<li>outputs:<ul>
<li>transients: list of <em class="xref std std-ref">Transient</em> objects,
amended with their classification.</li>
</ul>
</li>
</ul>
<div class="section" id="creating-your-own-manual-classification">
<h2>Creating your own manual classification<a class="headerlink" href="#creating-your-own-manual-classification" title="Permalink to this headline">¶</a></h2>
<p>By default, the classification recipe takes its classification (a
simple decision tree) from the <em class="xref std std-ref">classification module</em>. To create your own
decision tree, you have to create a simple Python file named
<tt class="file docutils literal"><span class="pre">classification.py</span></tt> in the default TKP configuration directory
(<tt class="file docutils literal"><span class="pre">$HOME/.transientskp/</span></tt>).</p>
<p>The contents of the Python file is a set of classes, where each class
is either the final outcome of the decision tree or a branch into a
further (sub)classification. Inside each class, there are one or more
methods that start their name with <cite>test</cite> which test for
characteristics of a specific transient using a simple <cite>if</cite>
statement. Each method returns a weight (0.0 by default, eg if the
<cite>if</cite> statement does not pass), and the added value of the weights
combine to the total weight of that specific classification.</p>
<p>A few examples should be clearer. Let&#8217;s start with the <cite>Main</cite> class,
which is the mandatory starting point. This will be a branch, so it
inherits from <tt class="xref py py-class docutils literal"><span class="pre">Branch</span></tt>. The
<cite>Main</cite> class has two <cite>test</cite> methods (simply named <cite>test1</cite> and
<cite>test2</cite>), which symbolize the two branches of the tree. Each branch
returns a list of classes it wants to test; in this example, these
will be classification classes, not subbranches:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tkp.classification.manual.classifier</span> <span class="kn">import</span> <span class="n">Branch</span>

<span class="k">class</span> <span class="nc">Main</span><span class="p">(</span><span class="n">Branch</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Starting point for the classification tree&quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">Transient1</span><span class="p">,</span> <span class="n">Transient2</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we need to define the <cite>Transient1</cite> and <cite>Transient2</cite>
classifications. Let&#8217;s simply classify on the duration of the
transient: one is for short transients, the second for long
transients; any duration in between will have no classification:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">tkp.classification.manual.classifier</span> <span class="kn">import</span> <span class="n">ClassifiedObject</span>

<span class="k">class</span> <span class="nc">Transient1</span><span class="p">(</span><span class="n">ClassifiedObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Short duration transient&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">test_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">&lt;</span> <span class="mf">1e3</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">1.0</span>

<span class="k">class</span> <span class="nc">Transient2</span><span class="p">(</span><span class="n">ClassifiedObject</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Long duration transient&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">test_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">&gt;</span> <span class="mf">1e5</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">1.0</span>
</pre></div>
</div>
<p>The <cite>duration</cite> attribute (<cite>self.duration</cite>) is automatically obtained
by inheriting from
<tt class="xref py py-class docutils literal"><span class="pre">ClassifiedTransient</span></tt>
or <tt class="xref py py-class docutils literal"><span class="pre">Branch</span></tt>: all
features obtained in the <a class="reference internal" href="recipes.html#feature-extraction"><em>feature extraction recipe</em></a> are available this way in the classification
tree.</p>
<p>We can also create branches dependent on the duration, instead of
direct classifications based on duration. On the branches, we classify
transients based on their duration, assign a weight to them if wanted,
and then further classify them using more specific classifiers. This
might look as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ShortDurationBranch</span><span class="p">(</span><span class="n">Branch</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">duration</span> <span class="o">&lt;</span> <span class="mf">1e3</span><span class="p">:</span>
            <span class="c"># Evaluate all classifications applicable for short transients</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">Transient3</span><span class="p">,</span> <span class="n">Transient4</span><span class="p">,</span> <span class="n">Transient5</span><span class="p">)</span>
            <span class="c"># Since this is a specific &quot;short duration&quot; branch,</span>
            <span class="c"># we return a score for a short transient</span>
            <span class="k">return</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Evaluate all classifications applicable for long transients</span>
            <span class="c"># Obviously, some classifications are applicable for both types</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">Transient5</span><span class="p">,</span> <span class="n">Transient6</span><span class="p">)</span>
</pre></div>
</div>
<p>But if you don&#8217;t want to make things complicated, you can thus
evaluate all separate classification classes, without branches (other
than the initial Main branch to start from).</p>
<p>The final result of the classification is a dictionary with the
weights for each classification (only the weights above the cutoff
level specified by the <cite>weight_cutoff</cite> input parameter are shown in
the final output).</p>
<p>The <em>class docstrings</em> are actually important here: these are the
dictionary <em>keys</em> of the resulting classification dictionary. The
dictionary values are the combined weights. For example, a
short and rapidly varying transient would have the following
classifications using the above scheme:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&#39;Short duration, rapid variability transient&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
 <span class="s">&#39;Short duration transient&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="available-features">
<h2>Available features<a class="headerlink" href="#available-features" title="Permalink to this headline">¶</a></h2>
<p>In the above classification module, features are accessible as
attributes of <cite>self</cite>, like <cite>self.duration</cite> and <cite>self.variability</cite>. The
TKP library tries to extract such features in the
<em class="xref std std-ref">tkpapi:features</em> module. The following features are available:</p>
<dl class="docutils">
<dt><cite>duration</cite></dt>
<dd>full duration of the transient</dd>
<dt><cite>variability</cite></dt>
<dd>a measure of the actual activity of the transient. It
is the ratio of the amount of time the transient light curve is
above background level, to the full duration of the transient. It is
always equal or smaller than 1.</dd>
<dt><cite>position</cite></dt>
<dd>a <tt class="xref py py-class docutils literal"><span class="pre">tkpapi:tkp.classification.manual.utils.Position</span></tt> object,
and has a <cite>match</cite> method to match with another <cite>Position</cite>
object. <cite>Position</cite> objects have an <cite>RA</cite>, <cite>Dec</cite> and an uncertainty on
the position.</dd>
<dt><cite>timezero</cite></dt>
<dd>the starting point of the transient, which is a
<tt class="xref py py-class docutils literal"><span class="pre">tkpapi:tkp.classifiation.manual.utils.DateTime</span></tt> object,
and has a <cite>match</cite> method to match with another <cite>DateTime</cite>
object. <cite>DateTime</cite> objects are very similar to the standard python
<cite>datetime.datetime</cite> objects, but have an extra <cite>error</cite> attribute
that indicates the accuracy of the time stamp in seconds.</dd>
<dt><cite>database</cite></dt>
<dd>a list of databases that are matched. For each matched
database, the list item is a dictionary with the database name
(abbreviation) as the key, and another (sub)dictionary as the
value. This subdictionary contains the information about the best
matched source, such as its <cite>ra</cite> and <cite>dec</cite>, the (dimensionless)
association parameter <cite>assoc_r</cite>, the source identifier in the
catalog <cite>catsrcname</cite> etc.</dd>
</dl>
<p>Finally, there is a dictionary attribute called <cite>features</cite>, which
contains all of the above features plus several others (note: at the
moment, the <cite>database</cite> list is not yet included here). While this may
seem a bit redundant, the point of this <cite>features</cite> attribute is that
it can easily be used by any automated classification routine, by
translating the dictionary into a feature vector that can be fed into
these classification routines.</p>
<p>The <cite>features</cite> attributes currently contains the following data:</p>
<dl class="docutils">
<dt><cite>wkurtosis</cite></dt>
<dd>(flux error) weighted kurtosis value</dd>
<dt><cite>wskew</cite></dt>
<dd>(flux error) weighted skew value</dd>
<dt><cite>wstddev</cite></dt>
<dd>(flux error) weighted standard deviation</dd>
<dt><cite>wmean</cite></dt>
<dd>(flux error) weighted mean</dd>
<dt><cite>median</cite></dt>
<dd>median flux value</dd>
<dt><cite>max</cite></dt>
<dd><cite>peakflux</cite>: maximum flux</dd>
<dt><cite>relpeakflux</cite></dt>
<dd>relative peak flux (relative to the background value)</dd>
<dt><cite>risefallratio</cite></dt>
<dd>ratio between the time of the increase to the peak flux, and the
time of the decrease from peak flux to background level</dd>
<dt><cite>duration</cite></dt>
<dd><cite>variability</cite></dd>
</dl>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
    <p class="logo"><a href="index.html">
      <img class="logo" src="_static/ackbar.png" alt="Ackbar" title="It's a TRAP!" />
    </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Classification</a><ul>
<li><a class="reference internal" href="#creating-your-own-manual-classification">Creating your own manual classification</a></li>
<li><a class="reference internal" href="#available-features">Available features</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="alerts.html"
                        title="previous chapter">Alerts recipe</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="monitoringlist.html"
                        title="next chapter">Monitoring list</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/classification.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="monitoringlist.html" title="Monitoring list"
             >next</a> |</li>
        <li class="right" >
          <a href="alerts.html" title="Alerts recipe"
             >previous</a> |</li>
        <li><a href="index.html">TRAP 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, LOFAR Transients Key Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>